(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{648:(e,t,i)=>{Promise.resolve().then(i.bind(i,6059))},6059:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>J});var n=i(5155),a=i(2115),r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"},s=(e,t)=>{let i=(0,a.forwardRef)((i,n)=>{let{color:s="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:c,children:d,...m}=i;return(0,a.createElement)("svg",{ref:n,...r,width:o,height:o,stroke:s,strokeWidth:c?24*Number(l)/Number(o):l,className:"lucide lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),...m},[...t.map(e=>{let[t,i]=e;return(0,a.createElement)(t,i)}),...(Array.isArray(d)?d:[d])||[]])});return i.displayName="".concat(e),i};let o=s("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),l=s("Layers",[["polygon",{points:"12 2 2 7 12 12 22 7 12 2",key:"1b0ttc"}],["polyline",{points:"2 17 12 22 22 17",key:"imjtdl"}],["polyline",{points:"2 12 12 17 22 12",key:"5dexcv"}]]),c=s("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),d=s("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),m=s("CheckSquare",[["polyline",{points:"9 11 12 14 22 4",key:"19ybtz"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),p=s("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),y=s("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z",key:"3xmgem"}]]),g=s("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),u=s("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),x=s("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),h=s("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),f=s("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),b=s("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),v=s("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),C=s("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),j=s("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),I=s("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),S={AC:"Access Control",AT:"Awareness and Training",AU:"Audit and Accountability",CA:"Assessment, Authorization, and Monitoring",CM:"Configuration Management",CP:"Contingency Planning",IA:"Identification and Authentication",IR:"Incident Response",MA:"Maintenance",MP:"Media Protection",PE:"Physical and Environmental Protection",PL:"Planning",PM:"Program Management",PS:"Personnel Security",PT:"Personally Identifiable Information Processing and Transparency",RA:"Risk Assessment",SA:"System and Services Acquisition",SC:"System and Communications Protection",SI:"System and Information Integrity",SR:"Supply Chain Risk Management"};function w(e){let{requirements:t,onUpdate:i}=e,[r,s]=(0,a.useState)(!1),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)(new Set),[m,p]=(0,a.useState)({title:"",description:"",source:"",category:"Authentication",priority:"Medium",status:"Draft",nistFunction:void 0,nistSubcategory:"",rmfStep:void 0,controlFamily:"",controlIdentifier:""}),g=()=>{p({title:"",description:"",source:"",category:"Authentication",priority:"Medium",status:"Draft",nistFunction:void 0,nistSubcategory:"",rmfStep:void 0,controlFamily:"",controlIdentifier:""}),l(null),s(!1)},u=t.reduce((e,t)=>{let i=t.controlFamily||"Other";return e[i]||(e[i]=[]),e[i].push(t),e},{}),x=Object.keys(u).sort();return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"NIST 800-53 Security Requirements"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Define security controls based on system categorization"}),(0,n.jsxs)("div",{className:"mt-2 text-sm text-blue-600",children:[(0,n.jsx)("strong",{children:"Step 3:"})," Generate security requirements based on your system categorization and design elements"]})]}),(0,n.jsxs)("button",{onClick:()=>s(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(h,{className:"h-4 w-4 mr-2"}),"Add Requirement"]})]}),(0,n.jsx)("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200",children:(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center text-green-600 font-medium",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"✓"}),"Design Elements"]}),(0,n.jsx)("div",{className:"text-gray-400",children:"→"}),(0,n.jsxs)("div",{className:"flex items-center text-green-600 font-medium",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"✓"}),"NIST 800-60 Categorization"]}),(0,n.jsx)("div",{className:"text-gray-400",children:"→"}),(0,n.jsxs)("div",{className:"flex items-center text-blue-600 font-medium",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),"NIST 800-53 Requirements"]})]}),t.length>0&&(0,n.jsxs)("div",{className:"text-sm text-green-600 font-medium",children:["✓ ",t.length," requirement",1!==t.length?"s":""," defined"]})]})}),r&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:o?"Edit Requirement":"Add New Requirement"}),(0,n.jsx)("button",{onClick:g,className:"text-gray-500 hover:text-gray-700",children:(0,n.jsx)(f,{className:"h-5 w-5"})})]}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),o?i(t.map(e=>e.id===o?{...e,...m,updatedAt:new Date}:e)):i([...t,{id:Date.now().toString(),title:m.title,description:m.description,source:m.source,category:m.category,priority:m.priority,status:m.status,createdAt:new Date,updatedAt:new Date}]),g()},className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title *"}),(0,n.jsx)("input",{type:"text",value:m.title||"",onChange:e=>p(t=>({...t,title:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,n.jsx)("textarea",{value:m.description||"",onChange:e=>p(t=>({...t,description:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Source"}),(0,n.jsx)("input",{type:"text",value:m.source||"",onChange:e=>p(t=>({...t,source:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., NIST, ISO 27001"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),(0,n.jsxs)("select",{value:m.category||"Authentication",onChange:e=>p(t=>({...t,category:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"Authentication",children:"Authentication"}),(0,n.jsx)("option",{value:"Authorization",children:"Authorization"}),(0,n.jsx)("option",{value:"Encryption",children:"Encryption"}),(0,n.jsx)("option",{value:"Audit",children:"Audit"}),(0,n.jsx)("option",{value:"Input Validation",children:"Input Validation"}),(0,n.jsx)("option",{value:"Access Control",children:"Access Control"}),(0,n.jsx)("option",{value:"Data Protection",children:"Data Protection"}),(0,n.jsx)("option",{value:"Network Security",children:"Network Security"}),(0,n.jsx)("option",{value:"System Integrity",children:"System Integrity"}),(0,n.jsx)("option",{value:"Incident Response",children:"Incident Response"}),(0,n.jsx)("option",{value:"Other",children:"Other"})]})]})]}),(0,n.jsxs)("div",{className:"border-t pt-4 mt-4",children:[(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-900 mb-3",children:"NIST Framework & RMF Mapping"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NIST CSF Function"}),(0,n.jsxs)("select",{value:m.nistFunction||"",onChange:e=>p(t=>({...t,nistFunction:e.target.value||void 0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"Select NIST Function"}),(0,n.jsx)("option",{value:"Identify",children:"Identify (ID)"}),(0,n.jsx)("option",{value:"Protect",children:"Protect (PR)"}),(0,n.jsx)("option",{value:"Detect",children:"Detect (DE)"}),(0,n.jsx)("option",{value:"Respond",children:"Respond (RS)"}),(0,n.jsx)("option",{value:"Recover",children:"Recover (RC)"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"RMF Step"}),(0,n.jsxs)("select",{value:m.rmfStep||"",onChange:e=>p(t=>({...t,rmfStep:e.target.value||void 0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"Select RMF Step"}),(0,n.jsx)("option",{value:"Categorize",children:"1. Categorize"}),(0,n.jsx)("option",{value:"Select",children:"2. Select"}),(0,n.jsx)("option",{value:"Implement",children:"3. Implement"}),(0,n.jsx)("option",{value:"Assess",children:"4. Assess"}),(0,n.jsx)("option",{value:"Authorize",children:"5. Authorize"}),(0,n.jsx)("option",{value:"Monitor",children:"6. Monitor"})]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Control Family"}),(0,n.jsxs)("select",{value:m.controlFamily||"",onChange:e=>p(t=>({...t,controlFamily:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"Select Control Family"}),(0,n.jsx)("option",{value:"AC",children:"AC - Access Control"}),(0,n.jsx)("option",{value:"AT",children:"AT - Awareness and Training"}),(0,n.jsx)("option",{value:"AU",children:"AU - Audit and Accountability"}),(0,n.jsx)("option",{value:"CA",children:"CA - Security Assessment and Authorization"}),(0,n.jsx)("option",{value:"CM",children:"CM - Configuration Management"}),(0,n.jsx)("option",{value:"CP",children:"CP - Contingency Planning"}),(0,n.jsx)("option",{value:"IA",children:"IA - Identification and Authentication"}),(0,n.jsx)("option",{value:"IR",children:"IR - Incident Response"}),(0,n.jsx)("option",{value:"MA",children:"MA - Maintenance"}),(0,n.jsx)("option",{value:"MP",children:"MP - Media Protection"}),(0,n.jsx)("option",{value:"PE",children:"PE - Physical and Environmental Protection"}),(0,n.jsx)("option",{value:"PL",children:"PL - Planning"}),(0,n.jsx)("option",{value:"PS",children:"PS - Personnel Security"}),(0,n.jsx)("option",{value:"RA",children:"RA - Risk Assessment"}),(0,n.jsx)("option",{value:"SA",children:"SA - System and Services Acquisition"}),(0,n.jsx)("option",{value:"SC",children:"SC - System and Communications Protection"}),(0,n.jsx)("option",{value:"SI",children:"SI - System and Information Integrity"}),(0,n.jsx)("option",{value:"SR",children:"SR - Supply Chain Risk Management"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Control Identifier"}),(0,n.jsx)("input",{type:"text",value:m.controlIdentifier||"",onChange:e=>p(t=>({...t,controlIdentifier:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., AC-2, AU-12"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"NIST Subcategory"}),(0,n.jsx)("input",{type:"text",value:m.nistSubcategory||"",onChange:e=>p(t=>({...t,nistSubcategory:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., ID.AM-1, PR.AC-1"})]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),(0,n.jsxs)("select",{value:m.priority||"Medium",onChange:e=>p(t=>({...t,priority:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"High",children:"High"}),(0,n.jsx)("option",{value:"Medium",children:"Medium"}),(0,n.jsx)("option",{value:"Low",children:"Low"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,n.jsxs)("select",{value:m.status||"Draft",onChange:e=>p(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"Draft",children:"Draft"}),(0,n.jsx)("option",{value:"Approved",children:"Approved"}),(0,n.jsx)("option",{value:"Implemented",children:"Implemented"}),(0,n.jsx)("option",{value:"Tested",children:"Tested"}),(0,n.jsx)("option",{value:"Verified",children:"Verified"})]})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:g,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,n.jsxs)("button",{type:"submit",className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(b,{className:"h-4 w-4 mr-2"}),o?"Update":"Create"]})]})]})]})}),(0,n.jsx)("div",{className:"space-y-4",children:0===t.length?(0,n.jsxs)("div",{className:"bg-white rounded-lg border p-8 text-center",children:[(0,n.jsx)(y,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,n.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Security Requirements"}),(0,n.jsx)("p",{className:"text-gray-500",children:'Click "Add Requirement" to get started or generate them from system categorization.'})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg border",children:[(0,n.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,n.jsx)("strong",{children:t.length})," requirement",1!==t.length?"s":""," across ",(0,n.jsx)("strong",{children:x.length})," control famil",1!==x.length?"ies":"y"]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>{d(new Set(x))},className:"text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:"Expand All"}),(0,n.jsx)("button",{onClick:()=>{d(new Set)},className:"text-sm px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition-colors",children:"Collapse All"})]})]}),x.map(e=>{let a=u[e],r=c.has(e);return(0,n.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[(0,n.jsxs)("button",{onClick:()=>(e=>{let t=new Set(c);t.has(e)?t.delete(e):t.add(e),d(t)})(e),className:"w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 transition-colors",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[r?(0,n.jsx)(v,{className:"h-5 w-5 text-gray-600"}):(0,n.jsx)(C,{className:"h-5 w-5 text-gray-600"}),(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsxs)("h3",{className:"text-lg font-semibold text-gray-900",children:[e," - ",S[e]||e]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[a.length," control",1!==a.length?"s":""]})]})]}),(0,n.jsx)("div",{className:"flex items-center space-x-2",children:["High","Medium","Low"].map(e=>{let t=a.filter(t=>t.priority===e).length;return 0===t?null:(0,n.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat("High"===e?"bg-red-100 text-red-800":"Medium"===e?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:[t," ",e]},e)})})]}),r&&(0,n.jsx)("div",{className:"divide-y divide-gray-200",children:a.map(e=>(0,n.jsx)("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3 mb-2",children:[e.controlIdentifier&&(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-sm font-semibold bg-blue-600 text-white rounded",children:e.controlIdentifier}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("h4",{className:"text-base font-semibold text-gray-900",children:e.title}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.description})]})]}),(0,n.jsxs)("div",{className:"flex flex-wrap gap-2 mt-3",children:[(0,n.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat("High"===e.priority?"bg-red-100 text-red-800":"Medium"===e.priority?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:[e.priority," Priority"]}),(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat("Approved"===e.status?"bg-green-100 text-green-800":"Implemented"===e.status?"bg-blue-100 text-blue-800":"Tested"===e.status?"bg-purple-100 text-purple-800":"Verified"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status}),e.category&&(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:e.category}),e.nistFunction&&(0,n.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:["NIST: ",e.nistFunction]}),e.rmfStep&&(0,n.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-purple-100 text-purple-800 rounded-full",children:["RMF: ",e.rmfStep]}),e.source&&(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-gray-100 text-gray-700 rounded-full",children:e.source})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,n.jsx)("button",{onClick:()=>{p(e),l(e.id),s(!0)},className:"text-blue-600 hover:text-blue-900",title:"Edit",children:(0,n.jsx)(j,{className:"h-4 w-4"})}),(0,n.jsx)("button",{onClick:()=>{var n;return n=e.id,void(confirm("Are you sure you want to delete this requirement?")&&i(t.filter(e=>e.id!==n)))},className:"text-red-600 hover:text-red-900",title:"Delete",children:(0,n.jsx)(I,{className:"h-4 w-4"})})]})]})},e.id))})]},e)})]})})]})}function A(e){let{designElements:t,onUpdate:i,onNavigateToNext:r}=e,[s,o]=(0,a.useState)(!1),[l,c]=(0,a.useState)(null),[d,m]=(0,a.useState)({name:"",type:"Component",description:"",technology:"",owner:""}),p=()=>{m({name:"",type:"Component",description:"",technology:"",owner:""}),c(null),o(!1)};return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"System Design Elements"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Define system components, modules, and interfaces"}),(0,n.jsxs)("div",{className:"mt-2 text-sm text-blue-600",children:[(0,n.jsx)("strong",{children:"Step 1:"})," Start by defining your system's design elements before categorization"]})]}),(0,n.jsxs)("button",{onClick:()=>o(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(h,{className:"h-4 w-4 mr-2"}),"Add Design Element"]})]}),(0,n.jsx)("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200",children:(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center text-blue-600 font-medium",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"1"}),"Design Elements"]}),(0,n.jsx)("div",{className:"text-gray-400",children:"→"}),(0,n.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-gray-300 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),"NIST 800-60 Categorization"]}),(0,n.jsx)("div",{className:"text-gray-400",children:"→"}),(0,n.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-gray-300 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),"NIST 800-53 Requirements"]})]}),t.length>0&&(0,n.jsxs)("div",{className:"text-sm text-green-600 font-medium",children:["✓ ",t.length," element",1!==t.length?"s":""," defined"]})]})}),s&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:l?"Edit Design Element":"Add New Design Element"}),(0,n.jsx)("button",{onClick:p,className:"text-gray-500 hover:text-gray-700",children:(0,n.jsx)(f,{className:"h-5 w-5"})})]}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),l?i(t.map(e=>e.id===l?{...e,...d,updatedAt:new Date}:e)):i([...t,{id:Date.now().toString(),name:d.name,type:d.type,description:d.description,technology:d.technology,owner:d.owner,createdAt:new Date,updatedAt:new Date}]),p()},className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Name *"}),(0,n.jsx)("input",{type:"text",value:d.name||"",onChange:e=>m(t=>({...t,name:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),(0,n.jsxs)("select",{value:d.type||"Component",onChange:e=>m(t=>({...t,type:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"Component",children:"Component"}),(0,n.jsx)("option",{value:"Module",children:"Module"}),(0,n.jsx)("option",{value:"Interface",children:"Interface"}),(0,n.jsx)("option",{value:"Service",children:"Service"}),(0,n.jsx)("option",{value:"Database",children:"Database"}),(0,n.jsx)("option",{value:"API",children:"API"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),(0,n.jsx)("textarea",{value:d.description||"",onChange:e=>m(t=>({...t,description:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Technology"}),(0,n.jsx)("input",{type:"text",value:d.technology||"",onChange:e=>m(t=>({...t,technology:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Node.js, React, AES-256"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner"}),(0,n.jsx)("input",{type:"text",value:d.owner||"",onChange:e=>m(t=>({...t,owner:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Development Team, Security Team"})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:p,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,n.jsxs)("button",{type:"submit",className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(b,{className:"h-4 w-4 mr-2"}),l?"Update":"Create"]})]})]})]})}),(0,n.jsxs)("div",{className:"bg-white rounded-lg border overflow-hidden",children:[(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Technology"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Owner"}),(0,n.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,n.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.map(e=>(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,n.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[e.description.substring(0,100),e.description.length>100&&"..."]})]})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-green-100 text-green-800 rounded-full",children:e.type})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.technology||"N/A"}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.owner||"N/A"}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,n.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,n.jsx)("button",{onClick:()=>{m(e),c(e.id),o(!0)},className:"text-blue-600 hover:text-blue-900",title:"Edit",children:(0,n.jsx)(j,{className:"h-4 w-4"})}),(0,n.jsx)("button",{onClick:()=>{var n;return n=e.id,void(confirm("Are you sure you want to delete this design element?")&&i(t.filter(e=>e.id!==n)))},className:"text-red-600 hover:text-red-900",title:"Delete",children:(0,n.jsx)(I,{className:"h-4 w-4"})})]})})]},e.id)),0===t.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:'No design elements found. Click "Add Design Element" to get started.'})})]})]})}),t.length>0&&(0,n.jsx)("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-green-800",children:"Design Elements Complete!"}),(0,n.jsx)("p",{className:"text-sm text-green-600",children:"Ready to proceed to system categorization"})]}),r&&(0,n.jsx)("button",{onClick:r,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Next: NIST 800-60 Categorization →"})]})})]})]})}let N=s("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),M=s("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);function T(e){let{data:t,onUpdate:i}=e,[r,s]=(0,a.useState)(!1),[o,l]=(0,a.useState)(null),[c,d]=(0,a.useState)("matrix"),[m,p]=(0,a.useState)({requirementId:"",designElementId:"",linkType:"Requirement-Design",status:"Active",rationale:""}),y=()=>{p({requirementId:"",designElementId:"",linkType:"Requirement-Design",status:"Active",rationale:""}),l(null),s(!1)};return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Traceability Matrix"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Track relationships between requirements and design elements"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[(0,n.jsxs)("button",{onClick:()=>d("matrix"),className:"flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat("matrix"===c?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,n.jsx)(N,{className:"h-4 w-4 mr-2"}),"Matrix View"]}),(0,n.jsxs)("button",{onClick:()=>d("list"),className:"flex items-center px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat("list"===c?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[(0,n.jsx)(M,{className:"h-4 w-4 mr-2"}),"List View"]})]}),(0,n.jsxs)("button",{onClick:()=>s(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(h,{className:"h-4 w-4 mr-2"}),"Add Link"]})]})]}),r&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:o?"Edit Traceability Link":"Add New Traceability Link"}),(0,n.jsx)("button",{onClick:y,className:"text-gray-500 hover:text-gray-700",children:(0,n.jsx)(f,{className:"h-5 w-5"})})]}),(0,n.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),o)i({traceabilityLinks:t.traceabilityLinks.map(e=>e.id===o?{...e,...m,updatedAt:new Date}:e)});else{let e={id:Date.now().toString(),requirementId:m.requirementId,designElementId:m.designElementId,linkType:m.linkType,status:m.status,rationale:m.rationale,createdAt:new Date,updatedAt:new Date};i({traceabilityLinks:[...t.traceabilityLinks,e]})}y()},className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Security Requirement *"}),(0,n.jsxs)("select",{value:m.requirementId||"",onChange:e=>p(t=>({...t,requirementId:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[(0,n.jsx)("option",{value:"",children:"Select a requirement"}),t.requirements.map(e=>(0,n.jsx)("option",{value:e.id,children:e.title},e.id))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Design Element"}),(0,n.jsxs)("select",{value:m.designElementId||"",onChange:e=>p(t=>({...t,designElementId:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"",children:"Select a design element (optional)"}),t.designElements.map(e=>(0,n.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link Type"}),(0,n.jsx)("select",{value:m.linkType||"Requirement-Design",onChange:e=>p(t=>({...t,linkType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:(0,n.jsx)("option",{value:"Requirement-Design",children:"Requirement-Design"})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),(0,n.jsxs)("select",{value:m.status||"Active",onChange:e=>p(t=>({...t,status:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,n.jsx)("option",{value:"Active",children:"Active"}),(0,n.jsx)("option",{value:"Inactive",children:"Inactive"})]})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rationale"}),(0,n.jsx)("textarea",{value:m.rationale||"",onChange:e=>p(t=>({...t,rationale:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Explain why this link exists..."})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:y,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,n.jsxs)("button",{type:"submit",className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(b,{className:"h-4 w-4 mr-2"}),o?"Update":"Create"]})]})]})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[(0,n.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:t.requirements.length}),(0,n.jsx)("div",{className:"text-sm text-blue-800",children:"Total Requirements"})]}),(0,n.jsxs)("div",{className:"bg-green-50 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-2xl font-bold text-green-600",children:t.traceabilityLinks.length}),(0,n.jsx)("div",{className:"text-sm text-green-800",children:"Total Links"})]}),(0,n.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4",children:[(0,n.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:t.requirements.filter(e=>t.traceabilityLinks.some(t=>t.requirementId===e.id&&"Active"===t.status)).length}),(0,n.jsx)("div",{className:"text-sm text-purple-800",children:"Covered Requirements"})]}),(0,n.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4",children:[(0,n.jsxs)("div",{className:"text-2xl font-bold text-orange-600",children:[t.requirements.length>0?Math.round(t.requirements.filter(e=>t.traceabilityLinks.some(t=>t.requirementId===e.id&&"Active"===t.status)).length/t.requirements.length*100):0,"%"]}),(0,n.jsx)("div",{className:"text-sm text-orange-800",children:"Coverage Percentage"})]})]}),"matrix"===c?(0,n.jsx)(()=>(0,n.jsx)("div",{className:"bg-white rounded-lg border overflow-hidden",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Security Requirement"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Design Elements"}),(0,n.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Coverage"})]})}),(0,n.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:t.requirements.map(e=>{var i;let a=(i=e.id,{designElements:t.traceabilityLinks.filter(e=>e.requirementId===i&&"Active"===e.status).filter(e=>e.designElementId).map(e=>t.designElements.find(t=>t.id===e.designElementId)).filter(Boolean)}),r=a.designElements.length>0;return(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,n.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[e.category," • ",e.priority," Priority"]}),(0,n.jsx)("div",{className:"text-xs px-2 py-1 mt-2 rounded-full inline-block ".concat("Approved"===e.status?"bg-green-100 text-green-800":"Implemented"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status})]})}),(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsxs)("div",{className:"space-y-1",children:[a.designElements.map(e=>(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded",children:e.name}),(0,n.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:e.type})]},e.id)),0===a.designElements.length&&(0,n.jsx)("span",{className:"text-xs text-gray-400",children:"No design elements linked"})]})}),(0,n.jsx)("td",{className:"px-6 py-4 text-center",children:(0,n.jsx)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(r?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:r?"Covered":"Not Covered"})})]},e.id)})})]})})}),{}):(0,n.jsx)(()=>(0,n.jsx)("div",{className:"bg-white rounded-lg border overflow-hidden",children:(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{className:"bg-gray-50",children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Requirement"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Design Element"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link Type"}),(0,n.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,n.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,n.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[t.traceabilityLinks.map(e=>{let a=t.requirements.find(t=>t.id===e.requirementId),r=e.designElementId?t.designElements.find(t=>t.id===e.designElementId):null;return(0,n.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,n.jsx)("td",{className:"px-6 py-4",children:(0,n.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null==a?void 0:a.title)||"Unknown Requirement"})}),(0,n.jsx)("td",{className:"px-6 py-4",children:r?(0,n.jsx)("div",{className:"text-sm text-gray-900",children:r.name}):(0,n.jsx)("span",{className:"text-sm text-gray-400",children:"N/A"})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium bg-gray-100 text-gray-800 rounded-full",children:e.linkType})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,n.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat("Active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.status})}),(0,n.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,n.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[(0,n.jsx)("button",{onClick:()=>{p(e),l(e.id),s(!0)},className:"text-blue-600 hover:text-blue-900",title:"Edit",children:(0,n.jsx)(j,{className:"h-4 w-4"})}),(0,n.jsx)("button",{onClick:()=>{var n;return n=e.id,void(confirm("Are you sure you want to delete this traceability link?")&&i({traceabilityLinks:t.traceabilityLinks.filter(e=>e.id!==n)}))},className:"text-red-600 hover:text-red-900",title:"Delete",children:(0,n.jsx)(I,{className:"h-4 w-4"})})]})})]},e.id)}),0===t.traceabilityLinks.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:5,className:"px-6 py-8 text-center text-gray-500",children:'No traceability links found. Click "Add Link" to get started.'})})]})]})})}),{})]})}let P=[{id:"application-security-dev",name:"Application Security and Development Security Technical Implementation Guide",version:"V6",releaseDate:"2025-02-12",description:"Security Technical Implementation Guide for Application Security and Development practices",applicableSystemTypes:["Application","Development","Web Application","API","Software"],triggerKeywords:["application","web app","api","development","software","code","programming","frontend","backend","secure coding","devsecops"],controlFamilies:["AC","AU","CM","IA","SC","SI","SA"],priority:"High",actualRequirements:165,stigId:"APSC-DV-000001",validated:!0},{id:"web-server-srg",name:"Web Server Security Requirements Guide",version:"V4",releaseDate:"2025-02-12",description:"Security Requirements Guide for Web Servers",applicableSystemTypes:["Web Server","HTTP","HTTPS","Web Application"],triggerKeywords:["web server","http server","https","web","server","webapp","hosting"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:89,stigId:"SRG-APP-000001",validated:!0},{id:"application-server-srg",name:"Application Server Security Requirements Guide",version:"V4",releaseDate:"2025-02-11",description:"Security Requirements Guide for Application Servers",applicableSystemTypes:["Application Server","App Server","Middleware"],triggerKeywords:["application server","app server","middleware","java","jee","j2ee"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:95,stigId:"SRG-APP-000002",validated:!0},{id:"apache-server-2-4-unix-server",name:"Apache Server 2.4 UNIX Server Security Technical Implementation Guide",version:"V3",releaseDate:"2024-12-04",description:"Security Technical Implementation Guide for Apache HTTP Server 2.4 on UNIX",applicableSystemTypes:["Web Server","Apache","HTTP","UNIX","Linux"],triggerKeywords:["apache","httpd","web server","http","https","ssl","tls","unix","linux"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:93,stigId:"AS24-U1-000001",validated:!0},{id:"apache-server-2-4-unix-site",name:"Apache Server 2.4 UNIX Site Security Technical Implementation Guide",version:"V2",releaseDate:"2025-02-12",description:"Security Technical Implementation Guide for Apache HTTP Server 2.4 UNIX Site configuration",applicableSystemTypes:["Web Server","Apache","HTTP","UNIX","Linux"],triggerKeywords:["apache","httpd","web server","site","virtual host","unix","linux"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:78,stigId:"AS24-U2-000001",validated:!0},{id:"apache-server-2-4-windows-server",name:"Apache Server 2.4 Windows Server Security Technical Implementation Guide",version:"V3",releaseDate:"2025-02-12",description:"Security Technical Implementation Guide for Apache HTTP Server 2.4 on Windows",applicableSystemTypes:["Web Server","Apache","HTTP","Windows"],triggerKeywords:["apache","httpd","web server","windows","http","https"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:93,stigId:"AS24-W1-000001",validated:!0},{id:"apache-server-2-4-windows-site",name:"Apache Server 2.4 Windows Site Security Technical Implementation Guide",version:"V2",releaseDate:"2025-02-12",description:"Security Technical Implementation Guide for Apache HTTP Server 2.4 Windows Site configuration",applicableSystemTypes:["Web Server","Apache","HTTP","Windows"],triggerKeywords:["apache","httpd","web server","site","virtual host","windows"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:78,stigId:"AS24-W2-000001",validated:!0},{id:"apache-tomcat-9",name:"Apache Tomcat Application Server 9 Security Technical Implementation Guide",version:"V3",releaseDate:"2025-02-11",description:"Security Technical Implementation Guide for Apache Tomcat 9 Application Server",applicableSystemTypes:["Application Server","Tomcat","Java","Servlet"],triggerKeywords:["tomcat","java","servlet","jsp","application server","java ee"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:112,stigId:"TCAT-AS-000001",validated:!0},{id:"microsoft-iis-10-server",name:"Microsoft IIS 10.0 Server Security Technical Implementation Guide",version:"V3",releaseDate:"2025-02-11",description:"Security Technical Implementation Guide for Microsoft Internet Information Services 10.0 Server",applicableSystemTypes:["Web Server","IIS","Windows","HTTP"],triggerKeywords:["iis","internet information services","web server","asp.net","windows web","microsoft"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:107,stigId:"IIST-SV-000001",validated:!0},{id:"microsoft-iis-10-site",name:"Microsoft IIS 10.0 Site Security Technical Implementation Guide",version:"V2",releaseDate:"2025-02-11",description:"Security Technical Implementation Guide for Microsoft Internet Information Services 10.0 Site configuration",applicableSystemTypes:["Web Server","IIS","Windows","HTTP"],triggerKeywords:["iis","internet information services","site","website","asp.net","windows web"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:89,stigId:"IIST-SI-000001",validated:!0},{id:"jboss-eap-6-3",name:"JBoss Enterprise Application Platform 6.3 Security Technical Implementation Guide",version:"V2",releaseDate:"2025-02-20",description:"Security Technical Implementation Guide for JBoss EAP 6.3",applicableSystemTypes:["Application Server","JBoss","Java","Red Hat"],triggerKeywords:["jboss","eap","wildfly","java","application server","red hat","java ee"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:98,stigId:"JBOS-AS-000001",validated:!0},{id:"ibm-websphere-liberty",name:"IBM WebSphere Liberty Server Security Technical Implementation Guide",version:"V2",releaseDate:"2025-02-11",description:"Security Technical Implementation Guide for IBM WebSphere Liberty Server",applicableSystemTypes:["Application Server","WebSphere","Java","IBM"],triggerKeywords:["websphere","liberty","ibm","java","application server","java ee"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:104,stigId:"WBSL-AS-000001",validated:!0},{id:"microsoft-dotnet-4",name:"Microsoft DotNet Framework 4.0 Security Technical Implementation Guide",version:"V2",releaseDate:"2025-02-20",description:"Security Technical Implementation Guide for Microsoft .NET Framework 4.0",applicableSystemTypes:["Framework",".NET","Application","Windows"],triggerKeywords:[".net","dotnet","framework","csharp","c#","asp.net","clr","microsoft"],controlFamilies:["AC","AU","CM","SC","SI","SA"],priority:"High",actualRequirements:91,stigId:"APPNET-AS-000001",validated:!0},{id:"windows-server-2022",name:"Windows Server 2022 STIG",version:"V2",releaseDate:"2025-02-25",description:"Security Technical Implementation Guide for Windows Server 2022",applicableSystemTypes:["Windows","Server","Domain Controller","File Server"],triggerKeywords:["windows","server 2022","windows server","active directory","domain","ntfs","registry","powershell"],controlFamilies:["AC","AU","CM","IA","SC","SI"],priority:"High",actualRequirements:292,stigId:"WN22-00-000010",validated:!1},{id:"windows-11",name:"Windows 11 STIG",version:"V2R2",releaseDate:"2024-08-15",description:"Security Technical Implementation Guide for Windows 11",applicableSystemTypes:["Windows","Workstation","Desktop","Laptop"],triggerKeywords:["windows 11","windows","workstation","desktop","laptop","endpoint"],controlFamilies:["AC","AU","CM","IA","SC","SI"],priority:"High",actualRequirements:204,stigId:"WN11-00-000010",validated:!1},{id:"rhel-9",name:"Red Hat Enterprise Linux 9 STIG",version:"V2R1",releaseDate:"2024-09-01",description:"Security Technical Implementation Guide for RHEL 9",applicableSystemTypes:["Linux","RHEL","Red Hat","Unix"],triggerKeywords:["linux","rhel","redhat","red hat","unix","bash","systemd","selinux","centos"],controlFamilies:["AC","AU","CM","IA","SC","SI"],priority:"High",actualRequirements:280,stigId:"RHEL-09-010001",validated:!1},{id:"ubuntu-22-04",name:"Canonical Ubuntu 22.04 LTS STIG",version:"V2R1",releaseDate:"2024-07-01",description:"Security Technical Implementation Guide for Ubuntu 22.04 LTS",applicableSystemTypes:["Linux","Ubuntu","Debian"],triggerKeywords:["ubuntu","debian","apt","snap","systemd","apparmor"],controlFamilies:["AC","AU","CM","IA","SC","SI"],priority:"High",actualRequirements:267,stigId:"UBTU-22-010001",validated:!1},{id:"cisco-ios-xe-17",name:"Cisco IOS XE Router STIG",version:"V3R3",releaseDate:"2024-04-19",description:"Security Technical Implementation Guide for Cisco IOS XE 17.x Routers",applicableSystemTypes:["Router","Network","Cisco","Infrastructure"],triggerKeywords:["cisco","ios xe","router","routing","ospf","bgp","snmp","acl"],controlFamilies:["AC","AU","CM","SC"],priority:"High",actualRequirements:152,stigId:"CISC-RT-000010",validated:!1},{id:"cisco-ios-switch",name:"Cisco IOS Switch STIG",version:"V3R2",releaseDate:"2024-04-19",description:"Security Technical Implementation Guide for Cisco IOS Switches",applicableSystemTypes:["Switch","Network","Cisco","Infrastructure"],triggerKeywords:["cisco","ios","switch","switching","vlan","stp","port security"],controlFamilies:["AC","AU","CM","SC"],priority:"High",actualRequirements:141,stigId:"CISC-L2S-000010",validated:!1},{id:"vmware-vsphere-8",name:"VMware vSphere 8.0 STIG",version:"V2R1",releaseDate:"2024-10-24",description:"Security Technical Implementation Guide for VMware vSphere 8.0",applicableSystemTypes:["VMware","Virtualization","Hypervisor","Cloud"],triggerKeywords:["vmware","vsphere","vcenter","esxi","virtualization","hypervisor","vm"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:234,stigId:"VMCH-80-000001",validated:!1},{id:"docker-enterprise",name:"Docker Enterprise 2.x STIG",version:"V2R2",releaseDate:"2023-06-15",description:"Security Technical Implementation Guide for Docker Enterprise",applicableSystemTypes:["Docker","Container","Cloud"],triggerKeywords:["docker","container","containerization"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"Medium",actualRequirements:103,stigId:"DKER-EE-001000",validated:!1},{id:"kubernetes",name:"Kubernetes STIG",version:"V2R1",releaseDate:"2024-05-10",description:"Security Technical Implementation Guide for Kubernetes",applicableSystemTypes:["Container","Kubernetes","Orchestration","Cloud"],triggerKeywords:["kubernetes","k8s","container orchestration","pod","deployment","service","cluster"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:97,stigId:"CNTR-K8-000110",validated:!1},{id:"apache-server-2-4",name:"Apache Server 2.4 STIG",version:"V3R1",releaseDate:"2024-03-22",description:"Security Technical Implementation Guide for Apache HTTP Server 2.4",applicableSystemTypes:["Web Server","Apache","HTTP"],triggerKeywords:["apache","httpd","web server","http","https","ssl","tls"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:93,stigId:"AS24-U1-000010",validated:!1},{id:"microsoft-iis-10",name:"Microsoft IIS 10.0 Server STIG",version:"V3R1",releaseDate:"2024-06-28",description:"Security Technical Implementation Guide for Microsoft Internet Information Services 10.0",applicableSystemTypes:["Web Server","IIS","Windows","HTTP"],triggerKeywords:["iis","internet information services","web server","asp.net","windows web"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:107,stigId:"IIST-SV-000101",validated:!1},{id:"microsoft-sql-server-2022",name:"MS SQL Server 2022 Instance STIG",version:"V1R1",releaseDate:"2024-06-21",description:"Security Technical Implementation Guide for Microsoft SQL Server 2022",applicableSystemTypes:["Database","SQL Server","Microsoft","RDBMS"],triggerKeywords:["sql server","mssql","database","rdbms","tsql","sql","microsoft database"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:138,stigId:"SQL6-D0-000100",validated:!1},{id:"oracle-database-19c",name:"Oracle Database 19c STIG",version:"V3R1",releaseDate:"2024-06-21",description:"Security Technical Implementation Guide for Oracle Database 19c",applicableSystemTypes:["Database","Oracle","RDBMS"],triggerKeywords:["oracle","database","rdbms","plsql","oracle db"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:156,stigId:"O121-C2-000100",validated:!1},{id:"postgresql-9x",name:"PostgreSQL 9.x STIG",version:"V2R5",releaseDate:"2023-09-12",description:"Security Technical Implementation Guide for PostgreSQL Database 9.x",applicableSystemTypes:["Database","PostgreSQL","RDBMS","Open Source"],triggerKeywords:["postgresql","postgres","database","rdbms","sql","db","psql"],controlFamilies:["AC","AU","CM","SC","SI"],priority:"High",actualRequirements:122,stigId:"PGS9-00-000100",validated:!1}],k={KEYWORD_MATCH_BASE:2,KEYWORD_MATCH_APP_SECURITY:3,CONTROL_FAMILY_MATCH:3,DESIGN_ELEMENT_KEYWORD:2,DESIGN_ELEMENT_TYPE:3,DESIGN_ELEMENT_EXACT_TECH:6,DEVELOPMENT_ENVIRONMENT_BONUS:5,INFRASTRUCTURE_PENALTY_IN_DEV:-3,MIN_CRITICAL_CONFIDENCE:80,MIN_HIGH_CONFIDENCE:60,MIN_MEDIUM_CONFIDENCE:40};function L(e){return e.includes("application")||e.includes("web")}function R(e,t,i){let n={"postgresql-9x":["postgresql"],"docker-enterprise":["docker"],kubernetes:["kubernetes"],"apache-server-2-4":["apache"]}[t];return!!n&&n.some(e=>i.has(e))}function E(e){let{stigRequirements:t,onUpdate:i}=e,[r,s]=(0,a.useState)(new Set),o=t.reduce((e,t)=>{let i=t.family||t.stigRef||"Unknown";return e[i]||(e[i]=[]),e[i].push(t),e},{});return(0,n.jsxs)("div",{className:"p-6 space-y-4",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold",children:"STIG Requirements"}),(0,n.jsxs)("button",{onClick:()=>{window.confirm("Are you sure you want to clear all STIG requirements?")&&i([])},disabled:0===t.length,className:"px-3 py-1 bg-red-100 text-red-600 rounded disabled:opacity-50",children:[(0,n.jsx)(I,{className:"inline-block mr-1"})," Clear All"]})]}),0===t.length&&(0,n.jsx)("p",{className:"text-gray-500",children:"No STIG requirements loaded. Please select STIG families first."}),Object.entries(o).map(e=>{let[t,i]=e,a=P.find(e=>e.stigId===t||e.id===t),o=a?a.name:t,l=r.has(t);return(0,n.jsxs)("div",{className:"border rounded-lg",children:[(0,n.jsxs)("button",{onClick:()=>{let e=new Set(r);e.has(t)?e.delete(t):e.add(t),s(e)},className:"w-full flex justify-between items-center p-4 bg-gray-100 hover:bg-gray-200 transition",children:[(0,n.jsxs)("span",{className:"font-medium",children:[o," (",i.length,")"]}),l?(0,n.jsx)(v,{}):(0,n.jsx)(C,{})]}),l&&(0,n.jsx)("ul",{className:"p-4 bg-white list-disc list-inside space-y-2",children:i.map(e=>(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"font-semibold",children:e.stigId}),": ",e.title]},e.id))})]},t)})]})}var D=i(4264),q=i.n(D);let U=[{category:"C.2.1",name:"Controls and Oversight",description:"Management controls and oversight activities",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.2.1.1",name:"Corrective Action Information Type",description:"Information supporting corrective action processes",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.1.2",name:"Program Evaluation Information Type",description:"Information supporting program evaluation activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.1.3",name:"Program Monitoring Information Type",description:"Information supporting program monitoring activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.2.2",name:"Regulatory Development",description:"Development and management of regulations",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.2.2.1",name:"Policy and Guidance Development Information Type",description:"Information supporting policy and guidance development",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.2.2",name:"Public Comment Tracking Information Type",description:"Information supporting public comment tracking",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.2.3",name:"Regulatory Creation Information Type",description:"Information supporting regulatory creation processes",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.2.4",name:"Rule Publication Information Type",description:"Information supporting rule publication processes",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.2.3",name:"Planning and Budgeting",description:"Strategic planning and budget management",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.2.3.1",name:"Budget Formulation Information Type",description:"Information supporting budget formulation processes",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.2",name:"Capital Planning Information Type",description:"Information supporting capital planning activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.3",name:"Enterprise Architecture Information Type",description:"Information supporting enterprise architecture management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.4",name:"Strategic Planning Information Type",description:"Information supporting strategic planning activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.5",name:"Budget Execution Information Type",description:"Information supporting budget execution processes",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.6",name:"Workforce Planning Information Type",description:"Information supporting workforce planning activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.7",name:"Management Improvement Information Type",description:"Information supporting management improvement initiatives",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.8",name:"Budget and Performance Integration Information Type",description:"Information supporting budget and performance integration",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.3.9",name:"Tax and Fiscal Policy Information Type",description:"Information supporting tax and fiscal policy development",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.2.4",name:"Internal Risk Management and Mitigation",description:"Risk management and business continuity",confidentiality:"Moderate",integrity:"High",availability:"Moderate",subtypes:[{category:"C.2.4.1",name:"Contingency Planning Information Type",description:"Information supporting contingency planning activities",confidentiality:"Moderate",integrity:"High",availability:"High"},{category:"C.2.4.2",name:"Continuity of Operations Information Type",description:"Information supporting continuity of operations planning",confidentiality:"Moderate",integrity:"High",availability:"High"},{category:"C.2.4.3",name:"Service Recovery Information Type",description:"Information supporting service recovery processes",confidentiality:"Low",integrity:"High",availability:"High"}]},{category:"C.2.5",name:"Revenue Collection",description:"Government revenue collection activities",confidentiality:"Moderate",integrity:"High",availability:"Low",subtypes:[{category:"C.2.5.1",name:"Debt Collection Information Type",description:"Information supporting debt collection activities",confidentiality:"Moderate",integrity:"High",availability:"Low"},{category:"C.2.5.2",name:"User Fee Collection Information Type",description:"Information supporting user fee collection processes",confidentiality:"Moderate",integrity:"High",availability:"Low"},{category:"C.2.5.3",name:"Federal Asset Sales Information Type",description:"Information supporting federal asset sales",confidentiality:"Low",integrity:"High",availability:"Low"}]},{category:"C.2.6",name:"Public Affairs",description:"Public communications and outreach",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.2.6.1",name:"Customer Services Information Type",description:"Information supporting customer service operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.6.2",name:"Official Information Dissemination Information Type",description:"Information supporting official information dissemination",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.6.3",name:"Product Outreach Information Type",description:"Information supporting product outreach activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.6.4",name:"Public Relations Information Type",description:"Information supporting public relations activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.2.7",name:"Legislative Relations",description:"Congressional and legislative affairs",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.2.7.1",name:"Legislation Tracking Information Type",description:"Information supporting legislation tracking activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.7.2",name:"Legislation Testimony Information Type",description:"Information supporting legislative testimony",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.7.3",name:"Proposal Development Information Type",description:"Information supporting legislative proposal development",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.7.4",name:"Congressional Liaison Operations Information Type",description:"Information supporting congressional liaison operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.2.8",name:"General Government",description:"General government operations and services",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.2.8.1",name:"Central Fiscal Operations Information Type",description:"Information supporting central fiscal operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.2",name:"Legislative Functions Information Type",description:"Information supporting legislative functions",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.3",name:"Executive Functions Information Type",description:"Information supporting executive functions",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.4",name:"Central Property Management Information Type",description:"Information supporting central property management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.5",name:"Central Personnel Management Information Type",description:"Information supporting central personnel management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.6",name:"Taxation Management Information Type",description:"Information supporting taxation management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.7",name:"Central Records and Statistics Management Information Type",description:"Information supporting central records and statistics management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.8",name:"Income Information Information Type",description:"Information supporting income information management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.9",name:"Personal Identity and Authentication Information Information Type",description:"Information supporting personal identity and authentication",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.10",name:"Entitlement Event Information Information Type",description:"Information supporting entitlement event processing",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.11",name:"Representative Payee Information Information Type",description:"Information supporting representative payee operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.2.8.12",name:"General Information Information Type",description:"General information supporting government operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.3.1",name:"Administrative Management",description:"General administrative management functions",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.3.1.1",name:"Facilities, Fleet, and Equipment Management Information Type",description:"Information supporting facilities, fleet, and equipment management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.1.2",name:"Help Desk Services Information Type",description:"Information supporting help desk services",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.1.3",name:"Security Management Information Type",description:"Information supporting security management operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.1.4",name:"Travel Information Type",description:"Information supporting travel management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.1.5",name:"Workplace Policy Development and Management Information Type",description:"Information supporting workplace policy development and management",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.3.2",name:"Financial Management",description:"Financial management and accounting operations",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.3.2.1",name:"Assets and Liability Management Information Type",description:"Information supporting assets and liability management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.2.2",name:"Reporting and Information Information Type",description:"Information supporting financial reporting",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.2.3",name:"Funds Control Information Type",description:"Information supporting funds control operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.2.4",name:"Accounting Information Type",description:"Information supporting accounting operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.2.5",name:"Payments Information Type",description:"Information supporting payment processing",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.2.6",name:"Collections and Receivables Information Type",description:"Information supporting collections and receivables management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.2.7",name:"Cost Accounting/Performance Measurement Information Type",description:"Information supporting cost accounting and performance measurement",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.3.3",name:"Human Resource Management",description:"Human resources management and personnel operations",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.3.3.1",name:"HR Strategy Information Type",description:"Information supporting HR strategy development",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.2",name:"Staff Acquisition Information Type",description:"Information supporting staff acquisition processes",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.3",name:"Organization & Position Management Information Type",description:"Information supporting organization and position management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.4",name:"Compensation Management Information Type",description:"Information supporting compensation management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.5",name:"Benefits Management Information Type",description:"Information supporting benefits management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.6",name:"Employee Performance Management Information Type",description:"Information supporting employee performance management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.7",name:"Employee Relations Information Type",description:"Information supporting employee relations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.8",name:"Labor Relations Information Type",description:"Information supporting labor relations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.9",name:"Separation Management Information Type",description:"Information supporting separation management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.3.10",name:"Human Resources Development Information Type",description:"Information supporting human resources development",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.3.4",name:"Supply Chain Management",description:"Supply chain and procurement operations",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.3.4.1",name:"Goods Acquisition Information Type",description:"Information supporting goods acquisition",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.4.2",name:"Inventory Control Information Type",description:"Information supporting inventory control operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.4.3",name:"Logistics Management Information Type",description:"Information supporting logistics management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.4.4",name:"Services Acquisition Information Type",description:"Information supporting services acquisition",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"C.3.5",name:"Information and Technology Management",description:"Information technology and systems management",confidentiality:"Low",integrity:"Moderate",availability:"Low",subtypes:[{category:"C.3.5.1",name:"System Development Information Type",description:"Information supporting system development activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.2",name:"Lifecycle/Change Management Information Type",description:"Information supporting lifecycle and change management",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.3",name:"System Maintenance Information Type",description:"Information supporting system maintenance operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.4",name:"IT Infrastructure Maintenance Information Type",description:"Information supporting IT infrastructure maintenance",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.5",name:"Information Security Information Type",description:"Information supporting information security operations",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.6",name:"Record Retention Information Type",description:"Information supporting record retention processes",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.7",name:"Information Management Information Type",description:"Information supporting information management activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.8",name:"System and Network Monitoring Information Type",description:"Information supporting system and network monitoring",confidentiality:"Low",integrity:"Moderate",availability:"Low"},{category:"C.3.5.9",name:"Information Sharing Information Type",description:"Information supporting information sharing activities",confidentiality:"Low",integrity:"Moderate",availability:"Low"}]},{category:"D.1",name:"Defense and National Security",description:"Information supporting defense and national security operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.2",name:"Homeland Security",description:"Information supporting homeland security operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate",subtypes:[{category:"D.2.1",name:"Border and Transportation Security Information Type",description:"Information supporting border and transportation security",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.2.2",name:"Key Asset and Critical Infrastructure Protection Information Type",description:"Information supporting key asset and critical infrastructure protection",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.2.3",name:"Catastrophic Defense Information Type",description:"Information supporting catastrophic defense operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.2.4",name:"Executive Functions of the Executive Office of the President Information Type",description:"Information supporting EOP executive functions",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"}]},{category:"D.3",name:"Intelligence Operations",description:"Information supporting intelligence operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.4",name:"Disaster Management",description:"Information supporting disaster management operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate",subtypes:[{category:"D.4.1",name:"Disaster Monitoring and Prediction Information Type",description:"Information supporting disaster monitoring and prediction",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.4.2",name:"Disaster Preparedness and Planning Information Type",description:"Information supporting disaster preparedness and planning",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.4.3",name:"Disaster Repair and Restoration Information Type",description:"Information supporting disaster repair and restoration",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.4.4",name:"Emergency Response Information Type",description:"Information supporting emergency response operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"}]},{category:"D.5",name:"International Affairs and Commerce",description:"Information supporting international affairs and commerce",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate",subtypes:[{category:"D.5.1",name:"Foreign Affairs Information Type",description:"Information supporting foreign affairs operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.5.2",name:"International Development and Humanitarian Aid Information Type",description:"Information supporting international development and humanitarian aid",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.5.3",name:"Global Trade Information Type",description:"Information supporting global trade operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"}]},{category:"D.6",name:"Natural Resources",description:"Information supporting natural resources management",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.7",name:"Energy",description:"Information supporting energy operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.8",name:"Environmental Management",description:"Information supporting environmental management",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.9",name:"Economic Development",description:"Information supporting economic development",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.10",name:"Community and Social Services",description:"Information supporting community and social services",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.11",name:"Transportation",description:"Information supporting transportation operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.12",name:"Education",description:"Information supporting education operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.13",name:"Workforce Management",description:"Information supporting workforce management",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.14",name:"Health",description:"Information supporting health operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.15",name:"Income Security",description:"Information supporting income security operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.16",name:"Law Enforcement",description:"Information supporting law enforcement operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.17",name:"Litigation and Judicial Activities",description:"Information supporting litigation and judicial activities",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.18",name:"Federal Correctional Activities",description:"Information supporting federal correctional activities",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.19",name:"General Sciences and Innovation",description:"Information supporting general sciences and innovation",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.20",name:"Knowledge Creation and Management",description:"Information supporting knowledge creation and management",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.21",name:"Regulatory Compliance and Enforcement",description:"Information supporting regulatory compliance and enforcement",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.22",name:"Public Goods Creation and Management",description:"Information supporting public goods creation and management",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.23",name:"Federal Financial Assistance",description:"Information supporting federal financial assistance",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.24",name:"Credit and Insurance",description:"Information supporting credit and insurance operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.25",name:"Transfers to State/Local Governments",description:"Information supporting transfers to state/local governments",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.26",name:"Direct Services for Citizens",description:"Information supporting direct services for citizens",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate",subtypes:[{category:"D.26.1",name:"Military Operations Information Type",description:"Information supporting military operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"},{category:"D.26.2",name:"Civilian Operations Information Type",description:"Information supporting civilian operations",confidentiality:"Moderate",integrity:"Moderate",availability:"Moderate"}]}],F={Low:["AC-1","AC-2","AC-3","AC-7","AC-8","AC-14","AC-17","AC-18","AC-19","AC-20","AC-22","AT-1","AT-2","AT-2(2)","AT-3","AT-3(5)","AT-4","AU-1","AU-2","AU-3","AU-4","AU-5","AU-6","AU-8","AU-9","AU-11","AU-12","CA-1","CA-2","CA-3","CA-5","CA-6","CA-7","CA-9","CM-1","CM-2","CM-4","CM-5","CM-6","CM-7","CM-8","CM-9","CM-10","CM-11","CP-1","CP-2","CP-3","CP-4","CP-9","CP-10","IA-1","IA-2","IA-2(1)","IA-2(2)","IA-2(8)","IA-2(12)","IA-4","IA-5","IA-5(1)","IA-6","IA-7","IA-8","IA-8(1)","IA-8(2)","IA-8(4)","IA-11","IR-1","IR-2","IR-4","IR-5","IR-6","IR-7","IR-8","MA-1","MA-2","MA-4","MA-5","MA-6","MP-1","MP-2","MP-6","MP-7","PE-1","PE-2","PE-3","PE-6","PE-8","PE-12","PE-13","PE-14","PE-16","PL-1","PL-2","PL-4","PL-4(1)","PS-1","PS-2","PS-3","PS-4","PS-5","PS-6","PS-7","PS-8","PT-1","PT-2","PT-3","PT-4","PT-5","PT-6","PT-7","PT-8","RA-1","RA-3","RA-5","RA-5(2)","RA-7","SA-1","SA-2","SA-3","SA-4","SA-5","SA-9","SA-22","SC-1","SC-5","SC-7","SC-7(4)","SC-7(5)","SC-8","SC-8(1)","SC-12","SC-13","SC-15","SC-20","SC-21","SC-22","SC-23","SC-28","SC-28(1)","SC-39","SI-1","SI-2","SI-2(2)","SI-3","SI-4","SI-5","SI-12","SI-16","SR-1","SR-2","SR-2(1)","SR-3","SR-5","SR-8","SR-10","SR-11","SR-11(1)","SR-11(2)","SR-12"],Moderate:["AC-1","AC-2","AC-2(1)","AC-2(2)","AC-2(3)","AC-2(4)","AC-2(5)","AC-2(12)","AC-2(13)","AC-3","AC-4","AC-5","AC-6","AC-6(1)","AC-6(2)","AC-6(5)","AC-6(9)","AC-7","AC-8","AC-10","AC-11","AC-11(1)","AC-12","AC-14","AC-17","AC-17(1)","AC-17(2)","AC-17(3)","AC-17(4)","AC-18","AC-18(1)","AC-19","AC-19(5)","AC-20","AC-20(1)","AC-20(2)","AC-21","AC-22","AT-1","AT-2","AT-2(2)","AT-3","AT-3(3)","AT-3(5)","AT-4","AU-1","AU-2","AU-3","AU-3(1)","AU-4","AU-5","AU-6","AU-6(1)","AU-6(3)","AU-7","AU-7(1)","AU-8","AU-9","AU-9(4)","AU-11","AU-12","AU-12(1)","CA-1","CA-2","CA-2(1)","CA-3","CA-5","CA-6","CA-7","CA-7(1)","CA-7(4)","CA-9","CM-1","CM-2","CM-2(2)","CM-2(3)","CM-2(7)","CM-3","CM-3(2)","CM-4","CM-5","CM-5(1)","CM-6","CM-7","CM-7(1)","CM-7(2)","CM-7(5)","CM-8","CM-8(1)","CM-8(3)","CM-9","CM-10","CM-11","CM-12","CM-12(1)","CP-1","CP-2","CP-2(1)","CP-2(2)","CP-2(3)","CP-2(8)","CP-3","CP-3(1)","CP-4","CP-4(1)","CP-6","CP-6(1)","CP-6(3)","CP-7","CP-7(1)","CP-7(2)","CP-7(3)","CP-8","CP-8(1)","CP-9","CP-9(1)","CP-10","CP-10(2)","IA-1","IA-2","IA-2(1)","IA-2(2)","IA-2(8)","IA-2(12)","IA-3","IA-4","IA-4(4)","IA-5","IA-5(1)","IA-5(2)","IA-5(6)","IA-6","IA-7","IA-8","IA-8(1)","IA-8(2)","IA-8(4)","IA-11","IA-12","IA-12(2)","IA-12(3)","IR-1","IR-2","IR-3","IR-3(2)","IR-4","IR-4(1)","IR-5","IR-6","IR-6(1)","IR-7","IR-7(1)","IR-8","MA-1","MA-2","MA-3","MA-3(1)","MA-3(2)","MA-3(3)","MA-4","MA-4(3)","MA-5","MA-5(1)","MA-6","MP-1","MP-2","MP-3","MP-4","MP-5","MP-6","MP-6(2)","MP-7","PE-1","PE-2","PE-3","PE-3(1)","PE-4","PE-5","PE-6","PE-6(1)","PE-8","PE-9","PE-10","PE-11","PE-12","PE-13","PE-14","PE-15","PE-16","PE-17","PL-1","PL-2","PL-4","PL-4(1)","PL-8","PL-10","PL-11","PS-1","PS-2","PS-3","PS-4","PS-5","PS-6","PS-7","PS-8","PT-1","PT-2","PT-3","PT-4","PT-5","PT-5(2)","PT-6","PT-6(1)","PT-6(2)","PT-7","PT-7(1)","PT-7(2)","PT-8","RA-1","RA-2","RA-3","RA-3(1)","RA-5","RA-5(2)","RA-5(4)","RA-5(5)","RA-7","SA-1","SA-2","SA-3","SA-4","SA-4(1)","SA-4(2)","SA-4(9)","SA-4(10)","SA-5","SA-8","SA-9","SA-10","SA-11","SA-15","SA-16","SA-17","SA-22","SC-1","SC-2","SC-4","SC-5","SC-7","SC-7(3)","SC-7(4)","SC-7(5)","SC-7(7)","SC-7(8)","SC-7(18)","SC-8","SC-8(1)","SC-10","SC-12","SC-12(1)","SC-13","SC-15","SC-17","SC-18","SC-20","SC-21","SC-22","SC-23","SC-28","SC-28(1)","SC-39","SI-1","SI-2","SI-2(2)","SI-2(3)","SI-3","SI-3(1)","SI-4","SI-4(2)","SI-4(4)","SI-4(5)","SI-5","SI-7","SI-7(1)","SI-7(7)","SI-8","SI-10","SI-11","SI-12","SI-12(1)","SI-12(2)","SI-16","SR-1","SR-2","SR-2(1)","SR-3","SR-3(1)","SR-3(2)","SR-5","SR-6","SR-8","SR-9","SR-10","SR-11","SR-11(1)","SR-11(2)","SR-12"],High:["AC-1","AC-2","AC-2(1)","AC-2(2)","AC-2(3)","AC-2(4)","AC-2(5)","AC-2(11)","AC-2(12)","AC-2(13)","AC-3","AC-3(7)","AC-4","AC-4(4)","AC-5","AC-6","AC-6(1)","AC-6(2)","AC-6(3)","AC-6(5)","AC-6(7)","AC-6(9)","AC-6(10)","AC-7","AC-8","AC-10","AC-11","AC-11(1)","AC-12","AC-14","AC-17","AC-17(1)","AC-17(2)","AC-17(3)","AC-17(4)","AC-18","AC-18(1)","AC-18(3)","AC-18(4)","AC-18(5)","AC-19","AC-19(4)","AC-19(5)","AC-20","AC-20(1)","AC-20(2)","AC-21","AC-22","AT-1","AT-2","AT-2(2)","AT-2(3)","AT-3","AT-3(3)","AT-3(5)","AT-4","AU-1","AU-2","AU-3","AU-3(1)","AU-3(2)","AU-4","AU-5","AU-5(1)","AU-5(2)","AU-5(3)","AU-6","AU-6(1)","AU-6(3)","AU-6(5)","AU-6(6)","AU-7","AU-7(1)","AU-8","AU-9","AU-9(2)","AU-9(3)","AU-9(4)","AU-10","AU-11","AU-12","AU-12(1)","AU-12(3)","AU-16","AU-16(1)","AU-16(2)","CA-1","CA-2","CA-2(1)","CA-2(2)","CA-3","CA-3(6)","CA-5","CA-6","CA-7","CA-7(1)","CA-7(4)","CA-8","CA-8(1)","CA-9","CM-1","CM-2","CM-2(2)","CM-2(3)","CM-2(6)","CM-2(7)","CM-3","CM-3(1)","CM-3(2)","CM-3(6)","CM-4","CM-4(1)","CM-5","CM-5(1)","CM-6","CM-6(1)","CM-7","CM-7(1)","CM-7(2)","CM-7(5)","CM-8","CM-8(1)","CM-8(2)","CM-8(3)","CM-8(4)","CM-9","CM-10","CM-11","CM-12","CM-12(1)","CP-1","CP-2","CP-2(1)","CP-2(2)","CP-2(3)","CP-2(5)","CP-2(8)","CP-3","CP-3(1)","CP-4","CP-4(1)","CP-4(2)","CP-6","CP-6(1)","CP-6(2)","CP-6(3)","CP-7","CP-7(1)","CP-7(2)","CP-7(3)","CP-7(4)","CP-8","CP-8(1)","CP-8(2)","CP-8(3)","CP-9","CP-9(1)","CP-9(2)","CP-9(3)","CP-9(5)","CP-9(6)","CP-9(8)","CP-10","CP-10(2)","CP-10(4)","CP-13","IA-1","IA-2","IA-2(1)","IA-2(2)","IA-2(5)","IA-2(8)","IA-2(12)","IA-3","IA-4","IA-4(4)","IA-5","IA-5(1)","IA-5(2)","IA-5(6)","IA-6","IA-7","IA-8","IA-8(1)","IA-8(2)","IA-8(4)","IA-11","IA-12","IA-12(2)","IA-12(3)","IA-12(4)","IA-12(5)","IR-1","IR-2","IR-2(2)","IR-3","IR-3(2)","IR-4","IR-4(1)","IR-4(2)","IR-4(3)","IR-4(4)","IR-4(11)","IR-5","IR-6","IR-6(1)","IR-6(2)","IR-6(3)","IR-7","IR-7(1)","IR-8","MA-1","MA-2","MA-2(2)","MA-3","MA-3(1)","MA-3(2)","MA-3(3)","MA-4","MA-4(3)","MA-5","MA-5(1)","MA-6","MP-1","MP-2","MP-3","MP-4","MP-4(2)","MP-5","MP-6","MP-6(1)","MP-6(2)","MP-6(3)","MP-7","PE-1","PE-2","PE-2(1)","PE-3","PE-3(1)","PE-4","PE-5","PE-6","PE-6(1)","PE-6(4)","PE-8","PE-8(1)","PE-9","PE-10","PE-11","PE-11(1)","PE-11(2)","PE-12","PE-13","PE-13(1)","PE-13(2)","PE-14","PE-15","PE-15(1)","PE-16","PE-17","PE-18","PL-1","PL-2","PL-4","PL-4(1)","PL-8","PL-10","PL-11","PS-1","PS-2","PS-3","PS-4","PS-4(2)","PS-5","PS-6","PS-7","PS-8","PT-1","PT-2","PT-3","PT-4","PT-5","PT-5(2)","PT-6","PT-6(1)","PT-6(2)","PT-7","PT-7(1)","PT-7(2)","PT-8","RA-1","RA-2","RA-3","RA-3(1)","RA-3(3)","RA-5","RA-5(2)","RA-5(4)","RA-5(5)","RA-7","RA-9","SA-1","SA-2","SA-3","SA-4","SA-4(1)","SA-4(2)","SA-4(9)","SA-4(10)","SA-5","SA-8","SA-9","SA-10","SA-10(1)","SA-11","SA-15","SA-15(2)","SA-16","SA-17","SA-17(1)","SA-21","SA-22","SC-1","SC-2","SC-3","SC-4","SC-5","SC-7","SC-7(3)","SC-7(4)","SC-7(5)","SC-7(7)","SC-7(8)","SC-7(10)","SC-7(11)","SC-7(18)","SC-7(21)","SC-8","SC-8(1)","SC-10","SC-11","SC-12","SC-12(1)","SC-12(2)","SC-12(3)","SC-13","SC-15","SC-17","SC-18","SC-20","SC-21","SC-22","SC-23","SC-23(1)","SC-28","SC-28(1)","SC-39","SI-1","SI-2","SI-2(2)","SI-2(3)","SI-3","SI-3(1)","SI-3(4)","SI-4","SI-4(2)","SI-4(4)","SI-4(5)","SI-4(12)","SI-4(20)","SI-4(22)","SI-5","SI-5(1)","SI-7","SI-7(1)","SI-7(2)","SI-7(5)","SI-7(7)","SI-7(15)","SI-8","SI-8(2)","SI-8(3)","SI-10","SI-11","SI-12","SI-12(1)","SI-12(2)","SI-16","SR-1","SR-2","SR-2(1)","SR-3","SR-3(1)","SR-3(2)","SR-5","SR-6","SR-8","SR-9","SR-9(1)","SR-10","SR-11","SR-11(1)","SR-11(2)","SR-12"]},H={"AC-1":{controlId:"AC-1",controlFamily:"AC",title:"Access Control Policy and Procedures",description:"The organization develops, documents, and disseminates an access control policy and implements access control procedures.",priority:"High",nistFunction:"Protect",rmfStep:"Select"},"AC-2":{controlId:"AC-2",controlFamily:"AC",title:"Account Management",description:"The organization manages information system accounts including establishing, activating, modifying, disabling, and removing accounts.",priority:"High",nistFunction:"Protect",rmfStep:"Implement"},"AC-3":{controlId:"AC-3",controlFamily:"AC",title:"Access Enforcement",description:"The information system enforces approved authorizations for logical access to information and system resources.",priority:"High",nistFunction:"Protect",rmfStep:"Implement"}};function G(e){var t;let{systemCategorizations:i,onUpdate:r,onGenerateRequirements:s,onNavigateToNext:o}=e,[l,c]=(0,a.useState)(!1),[d,m]=(0,a.useState)(null),[p,u]=(0,a.useState)(null),[x,v]=(0,a.useState)({systemName:"",systemDescription:"",informationTypes:[],rationale:""}),C=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e.length)return{confidentiality:"Low",integrity:"Low",availability:"Low"};let t=e=>e.includes("High")?"High":e.includes("Moderate")?"Moderate":"Low";return{confidentiality:t(e.map(e=>e.confidentialityImpact)),integrity:t(e.map(e=>e.integrityImpact)),availability:t(e.map(e=>e.availabilityImpact))}}(x.informationTypes||[]);(0,a.useEffect)(()=>{x.informationTypes&&x.informationTypes.length>0&&N()},[x.informationTypes]);let S=()=>{v({systemName:"",systemDescription:"",informationTypes:[],rationale:""}),m(null),c(!1)},w=async e=>{let t=document.getElementById("categorization-".concat(e.id));if(t)try{let i=await q()(t,{backgroundColor:"#ffffff",scale:2,logging:!1,useCORS:!0}),n=document.createElement("a");n.download="".concat(e.systemName.replace(/\s+/g,"-"),"-categorization.png"),n.href=i.toDataURL("image/png"),n.click()}catch(e){console.error("Error exporting to PNG:",e),alert("Failed to export categorization. Please try again.")}},A=(e,t)=>{v(i=>{var n;return{...i,informationTypes:null==(n=i.informationTypes)?void 0:n.map((i,n)=>n===e?{...i,...t}:i)}})},N=()=>{},M=e=>{let t=[e.confidentiality,e.integrity,e.availability];return t.includes("High")?"High":t.includes("Moderate")?"Moderate":"Low"},T=e=>{switch(e){case"High":return"text-red-600 bg-red-100";case"Moderate":return"text-yellow-600 bg-yellow-100";case"Low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"NIST 800-60 System Categorization"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Information System Security Categorization and Impact Analysis"}),(0,n.jsxs)("div",{className:"mt-2 text-sm text-blue-600",children:[(0,n.jsx)("strong",{children:"Step 2:"})," After defining design elements, categorize information types and determine security impact levels"]})]}),(0,n.jsxs)("button",{onClick:()=>c(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(h,{className:"h-4 w-4 mr-2"}),"New Categorization"]})]}),(0,n.jsx)("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200",children:(0,n.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"flex items-center text-green-600 font-medium",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-green-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"✓"}),"Design Elements"]}),(0,n.jsx)("div",{className:"text-gray-400",children:"→"}),(0,n.jsxs)("div",{className:"flex items-center text-blue-600 font-medium",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-blue-600 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"2"}),"NIST 800-60 Categorization"]}),(0,n.jsx)("div",{className:"text-gray-400",children:"→"}),(0,n.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,n.jsx)("div",{className:"w-6 h-6 bg-gray-300 text-white rounded-full flex items-center justify-center text-xs mr-2",children:"3"}),"NIST 800-53 Requirements"]})]}),i.length>0&&(0,n.jsxs)("div",{className:"text-sm text-green-600 font-medium",children:["✓ ",i.length," system",1!==i.length?"s":""," categorized"]})]})}),l&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl mx-4 max-h-screen overflow-y-auto",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:d?"Edit System Categorization":"New System Categorization"}),(0,n.jsx)("button",{onClick:S,className:"text-gray-500 hover:text-gray-700",children:(0,n.jsx)(f,{className:"h-5 w-5"})})]}),(0,n.jsxs)("form",{onSubmit:e=>{e.preventDefault(),d?r(i.map(e=>e.id===d?{...e,...x,overallCategorization:C,updatedAt:new Date}:e)):r([...i,{id:Date.now().toString(),systemName:x.systemName,systemDescription:x.systemDescription,informationTypes:x.informationTypes,overallCategorization:C,rationale:x.rationale,createdAt:new Date,updatedAt:new Date}]),S()},className:"space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Name *"}),(0,n.jsx)("input",{type:"text",value:x.systemName||"",onChange:e=>v(t=>({...t,systemName:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"System Description *"}),(0,n.jsx)("textarea",{value:x.systemDescription||"",onChange:e=>v(t=>({...t,systemDescription:e.target.value})),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Information Types"}),(0,n.jsx)("button",{type:"button",onClick:()=>{let e={id:Date.now().toString(),name:"",description:"",category:"",confidentialityImpact:"Low",integrityImpact:"Low",availabilityImpact:"Low"};v(t=>({...t,informationTypes:[...t.informationTypes||[],e]}))},className:"text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded-md hover:bg-blue-200",children:"Add Information Type"})]}),(0,n.jsx)("div",{className:"space-y-4",children:null==(t=x.informationTypes)?void 0:t.map((e,t)=>(0,n.jsxs)("div",{className:"border rounded-lg p-4 bg-gray-50",children:[(0,n.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,n.jsxs)("h4",{className:"font-medium text-gray-900",children:["Information Type ",t+1]}),(0,n.jsx)("button",{type:"button",onClick:()=>{v(e=>{var i;return{...e,informationTypes:null==(i=e.informationTypes)?void 0:i.filter((e,i)=>i!==t)}})},className:"text-red-600 hover:text-red-800",children:(0,n.jsx)(I,{className:"h-4 w-4"})})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"NIST Category"}),(0,n.jsxs)("select",{value:e.category,onChange:e=>{let i=U.find(t=>t.category===e.target.value);if(!i){for(let t of U)if(t.subtypes&&(i=t.subtypes.find(t=>t.category===e.target.value)))break}let n={category:e.target.value,name:(null==i?void 0:i.name)||"",description:(null==i?void 0:i.description)||""};(null==i?void 0:i.confidentiality)&&(n.confidentialityImpact=i.confidentiality),(null==i?void 0:i.integrity)&&(n.integrityImpact=i.integrity),(null==i?void 0:i.availability)&&(n.availabilityImpact=i.availability),A(t,n),((null==i?void 0:i.confidentiality)||(null==i?void 0:i.integrity)||(null==i?void 0:i.availability))&&setTimeout(N,100)},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md",children:[(0,n.jsx)("option",{value:"",children:"Select Category"}),U.map(e=>[(0,n.jsxs)("option",{value:e.category,children:[e.category," - ",e.name]},e.category),...(e.subtypes||[]).map(t=>(0,n.jsxs)("option",{value:t.category,children:["\xa0\xa0",t.category," - ",t.name," (under ",e.category," - ",e.name,")"]},t.category))]).flat()]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Name"}),(0,n.jsx)("input",{type:"text",value:e.name,onChange:e=>A(t,{name:e.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Description"}),(0,n.jsx)("textarea",{value:e.description,onChange:e=>A(t,{description:e.target.value}),rows:2,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confidentiality Impact"}),(0,n.jsxs)("select",{value:e.confidentialityImpact,onChange:e=>{A(t,{confidentialityImpact:e.target.value}),setTimeout(N,100)},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md",children:[(0,n.jsx)("option",{value:"Low",children:"Low"}),(0,n.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,n.jsx)("option",{value:"High",children:"High"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Integrity Impact"}),(0,n.jsxs)("select",{value:e.integrityImpact,onChange:e=>{A(t,{integrityImpact:e.target.value}),setTimeout(N,100)},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md",children:[(0,n.jsx)("option",{value:"Low",children:"Low"}),(0,n.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,n.jsx)("option",{value:"High",children:"High"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Availability Impact"}),(0,n.jsxs)("select",{value:e.availabilityImpact,onChange:e=>{A(t,{availabilityImpact:e.target.value}),setTimeout(N,100)},className:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md",children:[(0,n.jsx)("option",{value:"Low",children:"Low"}),(0,n.jsx)("option",{value:"Moderate",children:"Moderate"}),(0,n.jsx)("option",{value:"High",children:"High"})]})]})]}),e.category&&(0,n.jsx)("div",{className:"mt-3 p-2 bg-blue-50 border border-blue-200 rounded-md",children:(0,n.jsxs)("p",{className:"text-xs text-blue-700",children:[(0,n.jsx)("span",{className:"font-medium",children:"\uD83D\uDCCB NIST Guidance:"})," Impact levels are auto-populated based on NIST SP 800-60 recommendations. You can manually adjust these values based on your specific system requirements and organizational policies."]})})]},t))})]}),(0,n.jsxs)("div",{className:"border-t pt-4",children:[(0,n.jsx)("h4",{className:"font-medium text-gray-900 mb-3",children:"Overall System Categorization"}),(0,n.jsx)("div",{className:"mb-3 p-3 bg-blue-50 border border-blue-200 rounded-md",children:(0,n.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,n.jsx)("span",{className:"font-medium",children:"\uD83D\uDCCA Auto-Calculated:"})," Per NIST SP 800-60, the overall system categorization is automatically determined as the highest impact level among all information types."]})}),(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confidentiality"}),(0,n.jsx)("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 font-medium text-center ".concat("High"===C.confidentiality?"text-red-700 bg-red-50 border-red-300":"Moderate"===C.confidentiality?"text-yellow-700 bg-yellow-50 border-yellow-300":"text-green-700 bg-green-50 border-green-300"),children:C.confidentiality})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Integrity"}),(0,n.jsx)("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 font-medium text-center ".concat("High"===C.integrity?"text-red-700 bg-red-50 border-red-300":"Moderate"===C.integrity?"text-yellow-700 bg-yellow-50 border-yellow-300":"text-green-700 bg-green-50 border-green-300"),children:C.integrity})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Availability"}),(0,n.jsx)("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 font-medium text-center ".concat("High"===C.availability?"text-red-700 bg-red-50 border-red-300":"Moderate"===C.availability?"text-yellow-700 bg-yellow-50 border-yellow-300":"text-green-700 bg-green-50 border-green-300"),children:C.availability})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rationale"}),(0,n.jsx)("textarea",{value:x.rationale||"",onChange:e=>v(t=>({...t,rationale:e.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Explain the rationale for this categorization..."})]})]}),(0,n.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:S,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),(0,n.jsxs)("button",{type:"submit",className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(b,{className:"h-4 w-4 mr-2"}),d?"Update":"Create"]})]})]})]})}),(0,n.jsxs)("div",{className:"space-y-4",children:[0===i.length?(0,n.jsxs)("div",{className:"bg-white rounded-lg border p-8 text-center",children:[(0,n.jsx)(y,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,n.jsx)("p",{className:"text-lg font-medium text-gray-900 mb-2",children:"No System Categorizations"}),(0,n.jsx)("p",{className:"text-gray-500",children:"Create a system categorization to begin security control selection."})]}):i.map(e=>{var t;return(0,n.jsxs)("div",{id:"categorization-".concat(e.id),className:"bg-white rounded-lg border",children:[(0,n.jsx)("div",{className:"bg-gray-800 text-white p-4 rounded-t-lg",children:(0,n.jsxs)("div",{className:"flex justify-between items-start",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:e.systemName}),(0,n.jsx)("p",{className:"text-gray-300 text-sm mt-1",children:e.systemDescription})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("button",{onClick:()=>w(e),className:"text-white hover:text-green-300",title:"Export as PNG",children:(0,n.jsx)(g,{className:"h-4 w-4"})}),(0,n.jsx)("button",{onClick:()=>{v(e),m(e.id),c(!0)},className:"text-white hover:text-blue-300",title:"Edit",children:(0,n.jsx)(j,{className:"h-4 w-4"})}),(0,n.jsx)("button",{onClick:()=>{var t;return t=e.id,void(confirm("Are you sure you want to delete this system categorization?")&&r(i.filter(e=>e.id!==t)))},className:"text-white hover:text-red-300",title:"Delete",children:(0,n.jsx)(I,{className:"h-4 w-4"})})]})]})}),(0,n.jsxs)("div",{className:"p-6",children:[e.informationTypes.length>0&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:"3.2.1 Identification of Information Types"}),(0,n.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Table 3-3. Provisional Information Types & Security Impact Levels"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"bg-gray-100",children:[(0,n.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-900",children:"Information Type"}),(0,n.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center text-sm font-semibold text-gray-900",children:"Confidentiality Impact Level"}),(0,n.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center text-sm font-semibold text-gray-900",children:"Integrity Impact Level"}),(0,n.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center text-sm font-semibold text-gray-900",children:"Availability Impact Level"})]})}),(0,n.jsx)("tbody",{children:e.informationTypes.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsxs)("td",{className:"border border-gray-300 px-4 py-3",children:[(0,n.jsxs)("div",{className:"font-medium text-gray-900 text-sm",children:[e.category,"-",e.name]}),(0,n.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:(e=>{for(let t of U)if(t.subtypes&&t.subtypes.find(t=>t.category===e))return"".concat(e," (under ").concat(t.category," - ").concat(t.name,")");return e})(e.category)})]}),(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-center",children:(0,n.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium rounded ".concat(T(e.confidentialityImpact)),children:e.confidentialityImpact})}),(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-center",children:(0,n.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium rounded ".concat(T(e.integrityImpact)),children:e.integrityImpact})}),(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-center",children:(0,n.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium rounded ".concat(T(e.availabilityImpact)),children:e.availabilityImpact})})]},t))})]})})]}),e.rationale&&(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:"3.2.2 Adjusting of Information Types and Security Impact Levels"}),(0,n.jsx)("div",{className:"bg-gray-50 border border-gray-300 rounded p-4",children:(0,n.jsx)("p",{className:"text-sm text-gray-700",children:e.rationale})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"text-base font-semibold text-gray-900 mb-3",children:"3.2.3 Information System Security Categorization"}),(0,n.jsx)("div",{className:"text-sm text-gray-700 mb-2",children:"Table 3-5. Security Objective Impacts"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"bg-gray-100",children:[(0,n.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-left text-sm font-semibold text-gray-900",children:"Security Objective"}),(0,n.jsx)("th",{className:"border border-gray-300 px-4 py-2 text-center text-sm font-semibold text-gray-900",children:"Low, Moderate or High"})]})}),(0,n.jsxs)("tbody",{children:[(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm font-medium text-gray-700",children:"Confidentiality"}),(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-center",children:(0,n.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium rounded ".concat(T(e.overallCategorization.confidentiality)),children:e.overallCategorization.confidentiality})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm font-medium text-gray-700",children:"Integrity"}),(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-center",children:(0,n.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium rounded ".concat(T(e.overallCategorization.integrity)),children:e.overallCategorization.integrity})})]}),(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-sm font-medium text-gray-700",children:"Availability"}),(0,n.jsx)("td",{className:"border border-gray-300 px-4 py-3 text-center",children:(0,n.jsx)("span",{className:"inline-block px-3 py-1 text-sm font-medium rounded ".concat(T(e.overallCategorization.availability)),children:e.overallCategorization.availability})})]})]})]})}),(0,n.jsx)("div",{className:"mt-4 bg-blue-50 border border-blue-200 rounded p-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["Security Control Baseline:",(0,n.jsx)("span",{className:"ml-2 inline-block px-3 py-1 text-sm font-semibold rounded ".concat(T(M(e.overallCategorization))),children:M(e.overallCategorization)})]})}),(0,n.jsxs)("div",{className:"text-sm text-gray-700",children:[(0,n.jsx)("span",{className:"font-medium",children:"Controls Required:"})," ",(null==(t=F[M(e.overallCategorization)])?void 0:t.length)||0]})]})})]})]})]},e.id)}),i.length>0&&(0,n.jsx)("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h4",{className:"font-medium text-green-800",children:"System Categorization Complete!"}),(0,n.jsx)("p",{className:"text-sm text-green-600",children:"Click next to automatically generate NIST 800-53 security contrls"})]}),o&&(0,n.jsx)("button",{onClick:()=>{i.forEach(e=>{let t=M(e.overallCategorization);s((F[t]||F.Low).map(i=>{let n=H[i]||{controlId:i,controlFamily:i.split("-")[0],title:"".concat(i," - Security Control"),description:"Implementation of NIST SP 800-53 control ".concat(i),priority:"Medium",nistFunction:"Protect",rmfStep:"Select"};return{id:"".concat(e.id,"-").concat(i,"-").concat(Date.now()),title:n.title,description:n.description,source:"NIST SP 800-53 (".concat(t," Baseline)"),category:({AC:"Access Control",AT:"Authentication",AU:"Audit",CA:"Authorization",CM:"System Integrity",CP:"Incident Response",IA:"Authentication",IR:"Incident Response",MA:"System Integrity",MP:"Data Protection",PE:"Access Control",PL:"System Integrity",PS:"Access Control",RA:"System Integrity",SA:"System Integrity",SC:"Network Security",SI:"System Integrity"})[n.controlFamily]||"Other",priority:n.priority,status:"Draft",nistFunction:n.nistFunction,rmfStep:n.rmfStep,controlFamily:n.controlFamily,controlIdentifier:n.controlId,createdAt:new Date,updatedAt:new Date}}))}),o()},className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Next: Generate & View NIST 800-53 Controls →"})]})})]})]})}let z={};async function O(e){let t=[],i=encodeURIComponent(e.join(",")),n="".concat(window.location.origin,"/api/fetch-stig-csv?familyIds=").concat(i);try{let i=await fetch(n);if(!i.ok)return console.error("Failed to fetch STIG CSVs from API: ".concat(i.status)),t;let a=await i.json();for(let i of e){let e=a[i];if(e){let n=function(e,t){let i=e.split("\n");if(i.length<2)return[];let n=i[0].split(",").map(e=>e.replace(/"/g,"").trim().toLowerCase().replace(/\s+/g,"")),a=[];for(let e=1;e<i.length;e++){let r=i[e].trim();if(!r)continue;let s=[],o="",l=!1;for(let e=0;e<r.length;e++){let t=r[e];'"'===t?l=!l:","!==t||l?o+=t:(s.push(o.trim()),o="")}s.push(o.trim());let c={severity:"medium",stigId:"",ruleTitle:"",fixText:"",discussion:"",checkContent:""};if(n.forEach((e,t)=>{if(s[t]){let i=s[t].replace(/^"|"$/g,"");switch(e){case"benchmarkname":c.benchmarkName=i;break;case"benchmarkid":c.benchmarkId=i;break;case"severity":c.severity=i;break;case"stigid":c.stigId=i;break;case"ruletitle":c.ruleTitle=i;break;case"fixtext":c.fixText=i;break;case"discussion":c.discussion=i;break;case"checkcontent":c.checkContent=i;break;case"ccis":c.ccis=i;break;case"groupid":c.groupId=i;break;case"ruleid":c.ruleId=i;break;case"status":c.status=i}}}),c.stigId&&c.ruleTitle){let e=function(e){let t=e.ccis?e.ccis.split("\n").filter(e=>e.includes("CCI-")).map(e=>{let t=e.match(/CCI-\d+/);return t?t[0]:""}).filter(e=>e):["CCI-000366"];return{stigId:e.stigId||e.ruleId||"UNKNOWN",vulnId:e.groupId||void 0,severity:(e=>{let t=e.toLowerCase();return"high"===t||"cat i"===t?"CAT I":"medium"===t||"cat ii"===t?"CAT II":"low"===t||"cat iii"===t?"CAT III":"CAT II"})(e.severity),title:e.ruleTitle||"Untitled Requirement",description:e.discussion||"No description provided",checkText:e.checkContent||"No check procedure provided",fixText:e.fixText||"No fix procedure provided",applicability:"Applicable",status:(e=>{if(!e)return"Not Started";let t=e.toLowerCase();return t.includes("progress")||t.includes("ongoing")?"In Progress":t.includes("complete")||t.includes("done")?"Completed":t.includes("exception")||t.includes("waiver")?"Exception Requested":"Not Started"})(e.status),implementationStatus:"Open",cciRef:t}}(c);t&&(e.family=t),a.push(e)}}return a}(e,i);t.push(...n)}else console.warn("No CSV data returned for ".concat(i))}}catch(e){console.error("Error fetching STIG CSVs via API:",e)}return t}async function V(e){let t=await O(e),i=[];return t.forEach((e,t)=>{let n=e.family||"unknown";i.push({id:"".concat(n,"-").concat(Date.now(),"-").concat(t),...e,createdAt:new Date,updatedAt:new Date})}),i}let B={},_=s("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),W=s("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),K=s("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]]);function Y(e){let{requirements:t,designElements:i,onLoadStigFamilies:r}=e,[s,o]=(0,a.useState)([]),[l,c]=(0,a.useState)(new Set),[p,u]=(0,a.useState)(new Set);(0,a.useEffect)(()=>{(t.length>0||i.length>0)&&o(function(e,t){let i=[];for(let n of P){let a=function(e,t,i){var n;let a={keywordMatches:0,controlFamilyMatches:0,designElementMatches:0,technologySpecificBonus:0,environmentBonus:0,penalties:0},r=[],s=[],o=[],l=i.some(e=>{let t="".concat(e.name," ").concat(e.description," ").concat(e.type," ").concat(e.technology||"").toLowerCase();return t.includes("node")||t.includes("javascript")||t.includes("postgres")||t.includes("api")||t.includes("application")||t.includes("web")||t.includes("frontend")||t.includes("backend")||t.includes("database")||t.includes("server")}),c=function(e){let t=new Set,i={postgresql:/postgres(ql)?/i,docker:/docker|container/i,kubernetes:/k8s|kubernetes/i,apache:/apache|httpd/i,windows:/windows/i,linux:/linux|ubuntu|rhel|redhat/i};return e.forEach(e=>{let n="".concat(e.name," ").concat(e.description," ").concat(e.type," ").concat(e.technology||"").toLowerCase();Object.entries(i).forEach(e=>{let[i,a]=e;a.test(n)&&t.add(i)})}),t}(i);for(let i of(l&&L(e.id)&&(a.environmentBonus=k.DEVELOPMENT_ENVIRONMENT_BONUS,o.push("✓ Development environment detected - application security controls are essential")),t)){let t="".concat(i.title," ").concat(i.description," ").concat(i.category," ").concat(i.controlFamily||""," ").concat(i.source).toLowerCase(),n=e.triggerKeywords.filter(e=>t.includes(e.toLowerCase()));if(n.length>0){let t=L(e.id)?k.KEYWORD_MATCH_APP_SECURITY:k.KEYWORD_MATCH_BASE;a.keywordMatches+=n.length*t,r.push(i.id),o.push('✓ Requirement "'.concat(i.title,'" matches: ').concat(n.join(", ")))}i.controlFamily&&e.controlFamilies.includes(i.controlFamily)&&(a.controlFamilyMatches+=k.CONTROL_FAMILY_MATCH,r.includes(i.id)||r.push(i.id),o.push("✓ Control family ".concat(i.controlFamily," applies to this STIG")))}for(let t of i){let i="".concat(t.name," ").concat(t.description," ").concat(t.type," ").concat(t.technology||"").toLowerCase(),n=e.triggerKeywords.filter(e=>i.includes(e.toLowerCase())),r=e.applicableSystemTypes.filter(e=>i.includes(e.toLowerCase())||t.type.toLowerCase().includes(e.toLowerCase()));(n.length>0||r.length>0)&&(R(i,e.id,c)&&(a.technologySpecificBonus+=k.DESIGN_ELEMENT_EXACT_TECH,o.push("⭐ Direct technology match: ".concat(t.name," requires specific ").concat(e.name))),a.designElementMatches+=n.length*k.DESIGN_ELEMENT_KEYWORD+r.length*k.DESIGN_ELEMENT_TYPE,s.push(t.id),n.length>0&&o.push('✓ Design element "'.concat(t.name,'" matches: ').concat(n.join(", "))),r.length>0&&o.push("✓ System type match: ".concat(r.join(", "))))}l&&((n=e.id).includes("windows-server")||n.includes("cisco")||n.includes("vmware")||n.includes("rhel")||n.includes("ubuntu"))&&(a.penalties=k.INFRASTRUCTURE_PENALTY_IN_DEV,a.keywordMatches+a.designElementMatches>0&&o.push("⚠ Infrastructure STIG - lower priority for application development")),a.keywordMatches,a.controlFamilyMatches,a.designElementMatches,a.technologySpecificBonus,a.environmentBonus,a.penalties;let d=function(e,t,i,n){let a;return a=0+Math.min(10*e,30)+Math.min(15*t,40),i.validated&&(a+=10),R("",i.id,n)&&(a+=20),Math.min(a,100)}(r.length,s.length,e,c),m="Low";return d>=k.MIN_CRITICAL_CONFIDENCE&&"High"===e.priority?m="Critical":d>=k.MIN_HIGH_CONFIDENCE||"High"===e.priority?m="High":(d>=k.MIN_MEDIUM_CONFIDENCE||"Medium"===e.priority)&&(m="Medium"),{stigFamily:e,confidenceScore:d,matchingRequirements:r,matchingDesignElements:s,reasoning:o,implementationPriority:m,scoreBreakdown:a}}(n,e,t);a.confidenceScore>0&&i.push(a)}return i.sort((e,t)=>t.confidenceScore-e.confidenceScore)}(t,i))},[t,i]);let x=()=>{l.size>0&&r(Array.from(l))},h=e=>{if(e.actualRequirements)return e.actualRequirements;let t=z[e.id]||[];if(t.length>0)return t.length;let i=B[e.id];return i?i.length:0},f=()=>Array.from(l).reduce((e,t)=>{let i=s.find(e=>e.stigFamily.id===t);return i?e+h(i.stigFamily):e},0);return 0===t.length&&0===i.length?(0,n.jsx)("div",{className:"p-6",children:(0,n.jsxs)("div",{className:"text-center py-12 text-gray-500",children:[(0,n.jsx)(y,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,n.jsx)("p",{className:"text-lg font-medium mb-2",children:"No Analysis Data Available"}),(0,n.jsx)("p",{children:"Add security requirements and design elements to get STIG family recommendations."})]})}):(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"STIG Family Recommendations"}),(0,n.jsxs)("p",{className:"text-gray-600",children:["Based on ",t.length," requirements and ",i.length," design elements"]})]})}),s.length>0&&(0,n.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(m,{className:"h-5 w-5 text-blue-600 mr-2"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-sm font-medium text-blue-900",children:[l.size," of ",s.length," STIG families selected"]}),(0,n.jsxs)("div",{className:"text-sm text-blue-700",children:[f()," detailed requirements ready to load"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("button",{onClick:()=>{c(new Set(s.map(e=>e.stigFamily.id)))},className:"px-3 py-1 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors",children:"Select All"}),(0,n.jsx)("button",{onClick:()=>{c(new Set)},className:"px-3 py-1 text-sm bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors",children:"Clear All"})]})]}),l.size>0&&(0,n.jsxs)("button",{onClick:x,className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[(0,n.jsx)(g,{className:"h-4 w-4 mr-2"}),"Load ",l.size," STIG Families (",f()," Requirements)"]})]})}),(0,n.jsx)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 mb-6",children:(0,n.jsxs)("div",{className:"flex items-start",children:[(0,n.jsx)(W,{className:"h-5 w-5 text-gray-500 mr-3 mt-0.5 flex-shrink-0"}),(0,n.jsx)("div",{children:(0,n.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,n.jsx)("strong",{children:"How to use:"}),' Click on the STIG families below to select them for your project. Selected families will be highlighted and added to your requirements when you click "Load STIG Families".']})})]})}),(0,n.jsx)("div",{className:"space-y-4",children:s.map(e=>{let t=l.has(e.stigFamily.id),i=h(e.stigFamily);return(0,n.jsx)("div",{onClick:()=>{var t;return t=e.stigFamily.id,void c(e=>{let i=new Set(e);return i.has(t)?i.delete(t):i.add(t),i})},className:"border rounded-lg p-6 cursor-pointer transition-all duration-200 ".concat(t?"border-blue-500 bg-blue-50 shadow-md":"border-gray-200 bg-white hover:border-gray-300 hover:shadow-sm"),children:(0,n.jsx)("div",{className:"flex justify-between items-start",children:(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"flex items-center mb-3",children:[(0,n.jsx)("div",{className:"w-5 h-5 rounded border-2 flex items-center justify-center mr-3 ".concat(t?"bg-blue-600 border-blue-600":"border-gray-300"),children:t&&(0,n.jsx)(m,{className:"h-3 w-3 text-white"})}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.stigFamily.name}),(0,n.jsx)("span",{className:"ml-3 px-2 py-1 text-xs font-medium rounded-full border ".concat((e=>{switch(e){case"Critical":return"bg-red-100 text-red-800 border-red-200";case"High":return"bg-orange-100 text-orange-800 border-orange-200";case"Medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"Low":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}})(e.implementationPriority)),children:(0,n.jsxs)("span",{className:"flex items-center",children:[(e=>{switch(e){case"Critical":return(0,n.jsx)(_,{className:"h-4 w-4"});case"High":return(0,n.jsx)(d,{className:"h-4 w-4"});case"Medium":default:return(0,n.jsx)(W,{className:"h-4 w-4"});case"Low":return(0,n.jsx)(K,{className:"h-4 w-4"})}})(e.implementationPriority),(0,n.jsx)("span",{className:"ml-1",children:e.implementationPriority})]})})]}),(0,n.jsx)("p",{className:"text-gray-600 mb-4",children:e.stigFamily.description}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"Requirements"}),(0,n.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:i}),e.stigFamily.validated&&(0,n.jsxs)("div",{className:"text-xs text-green-600 mt-1 flex items-center",children:[(0,n.jsx)(m,{className:"h-3 w-3 mr-1"}),"Validated"]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"Confidence Score"}),(0,n.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:[e.confidenceScore||0,"%"]})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"Est. Effort"}),(0,n.jsxs)("div",{className:"text-lg font-semibold text-gray-900",children:[Math.round(1.5*i)," hrs"]}),(0,n.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["~",Math.ceil(1.5*i/8)," days @ 8hrs/day"]})]})]}),e.reasoning.length>0&&(0,n.jsxs)("div",{className:"border-t pt-4",children:[(0,n.jsxs)("button",{onClick:t=>{var i;return i=e.stigFamily.id,void(t.stopPropagation(),u(e=>{let t=new Set(e);return t.has(i)?t.delete(i):t.add(i),t}))},className:"flex items-center justify-between w-full text-left hover:bg-gray-50 rounded p-2 transition-colors",children:[(0,n.jsxs)("h4",{className:"text-sm font-medium text-gray-900",children:["Why this STIG is recommended (",e.reasoning.length," reasons)"]}),p.has(e.stigFamily.id)?(0,n.jsx)(v,{className:"h-4 w-4 text-gray-500"}):(0,n.jsx)(C,{className:"h-4 w-4 text-gray-500"})]}),p.has(e.stigFamily.id)&&(0,n.jsxs)("div",{className:"mt-2 pl-2",children:[(0,n.jsx)("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1 mb-4",children:e.reasoning.map((e,t)=>(0,n.jsx)("li",{children:e},t))}),e.scoreBreakdown&&(0,n.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 mt-3",children:[(0,n.jsx)("h5",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Score Breakdown"}),(0,n.jsxs)("div",{className:"space-y-1 text-xs text-gray-600",children:[e.scoreBreakdown.keywordMatches>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Keyword Matches:"}),(0,n.jsxs)("span",{className:"font-medium text-green-600",children:["+",e.scoreBreakdown.keywordMatches.toFixed(1)]})]}),e.scoreBreakdown.controlFamilyMatches>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Control Family Matches:"}),(0,n.jsxs)("span",{className:"font-medium text-green-600",children:["+",e.scoreBreakdown.controlFamilyMatches.toFixed(1)]})]}),e.scoreBreakdown.designElementMatches>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Design Element Matches:"}),(0,n.jsxs)("span",{className:"font-medium text-green-600",children:["+",e.scoreBreakdown.designElementMatches.toFixed(1)]})]}),e.scoreBreakdown.technologySpecificBonus>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Technology Bonus:"}),(0,n.jsxs)("span",{className:"font-medium text-green-600",children:["+",e.scoreBreakdown.technologySpecificBonus.toFixed(1)]})]}),e.scoreBreakdown.environmentBonus>0&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Environment Bonus:"}),(0,n.jsxs)("span",{className:"font-medium text-green-600",children:["+",e.scoreBreakdown.environmentBonus.toFixed(1)]})]}),0!==e.scoreBreakdown.penalties&&(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:"Penalties:"}),(0,n.jsx)("span",{className:"font-medium text-red-600",children:e.scoreBreakdown.penalties.toFixed(1)})]}),(0,n.jsxs)("div",{className:"flex justify-between pt-1 border-t border-gray-300 font-semibold",children:[(0,n.jsx)("span",{children:"Confidence Score:"}),(0,n.jsxs)("span",{className:"text-blue-600",children:[e.confidenceScore,"%"]})]})]})]})]})]})]})})},e.stigFamily.id)})}),l.size>0&&(0,n.jsx)("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(m,{className:"h-5 w-5 text-green-600 mr-2"}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"text-sm font-medium text-green-900",children:["Ready to load ",l.size," STIG families"]}),(0,n.jsxs)("div",{className:"text-sm text-green-700",children:["This will add ",f()," detailed security requirements to your project"]})]})]}),(0,n.jsxs)("button",{onClick:x,className:"flex items-center px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:[(0,n.jsx)(g,{className:"h-4 w-4 mr-2"}),"Load Requirements"]})]})})]})}function J(){let[e,t]=(0,a.useState)([]),[i,r]=(0,a.useState)("design"),[s,h]=(0,a.useState)({requirements:[],designElements:[],traceabilityLinks:[],stigRequirements:[],systemCategorizations:[]});(0,a.useEffect)(()=>{h({requirements:[],designElements:[],traceabilityLinks:[],stigRequirements:[],systemCategorizations:[]})},[]);let f=[{id:"design",name:"Design Elements",icon:o},{id:"categorization",name:"NIST 800-60 Categorization",icon:l},{id:"requirements",name:"NIST 800-53 Requirements",icon:c},{id:"stig-families",name:"STIG Recommendations",icon:d},{id:"stig",name:"STIG Requirements",icon:m},{id:"matrix",name:"Traceability Matrix",icon:p}],b=e=>{h(t=>({...t,...e}))};return(0,n.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,n.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,n.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(y,{className:"h-8 w-8 text-blue-600 mr-3"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Security Requirements Traceability Matrix"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"NIST Framework • RMF • STIG Compliance"})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("button",{onClick:()=>{let e=new Blob([JSON.stringify({systemCategorizations:s.systemCategorizations,designElements:s.designElements,exportDate:new Date().toISOString(),version:"1.0"},null,2)],{type:"application/json"}),t=URL.createObjectURL(e),i=document.createElement("a");i.href=t,i.download="workflow-".concat(new Date().toISOString().split("T")[0],".json"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(t)},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,n.jsx)(g,{className:"h-4 w-4 mr-2"}),"Save Workflow"]}),(0,n.jsxs)("label",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors cursor-pointer",children:[(0,n.jsx)(u,{className:"h-4 w-4 mr-2"}),"Upload Workflow",(0,n.jsx)("input",{type:"file",accept:".json",onChange:e=>{var t;let i=null==(t=e.target.files)?void 0:t[0];if(!i)return;let n=new FileReader;n.onload=t=>{try{var i;let n=JSON.parse(null==(i=t.target)?void 0:i.result);h(e=>({...e,systemCategorizations:n.systemCategorizations,designElements:n.designElements})),n.designElements.length>0?n.systemCategorizations.length>0?r("requirements"):r("categorization"):r("design"),e.target.value=""}catch(e){console.error("Error parsing workflow file:",e),alert("Error parsing workflow file. Please ensure it's a valid JSON file.")}},n.readAsText(i)},className:"hidden"})]}),(0,n.jsxs)("button",{onClick:()=>{window.confirm("Are you sure you want to clear all workflow data? This action cannot be undone.")&&(h({requirements:[],designElements:[],traceabilityLinks:[],stigRequirements:[],systemCategorizations:[]}),r("design"))},className:"flex items-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[(0,n.jsx)(x,{className:"h-4 w-4 mr-2"}),"Clear Workflow"]})]})]})})}),(0,n.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,n.jsx)("nav",{className:"flex space-x-8 mb-8",children:f.map(e=>{let t=e.icon,a=!1,o="";return"categorization"===e.id&&0===s.designElements.length?(a=!0,o="Complete Design Elements first"):"requirements"===e.id&&(0===s.designElements.length||0===s.systemCategorizations.length)&&(a=!0,o="Complete Design Elements and System Categorization first"),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsxs)("button",{onClick:()=>!a&&r(e.id),disabled:a,className:"flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors ".concat(i===e.id?"bg-blue-100 text-blue-700":a?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),title:a?o:"",children:[(0,n.jsx)(t,{className:"h-4 w-4 mr-2"}),e.name]}),a&&(0,n.jsx)("div",{className:"absolute top-full left-0 mt-1 bg-gray-800 text-white text-xs px-2 py-1 rounded whitespace-nowrap opacity-0 hover:opacity-100 transition-opacity pointer-events-none",children:o})]},e.id)})}),"stig"===i&&e.length>0&&(0,n.jsxs)("div",{className:"mb-4 p-4 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded",children:["Warning: No CSV data returned for the following STIG families: ",e.join(", "),"."]}),"design"===i&&(0,n.jsx)(A,{designElements:s.designElements,onUpdate:e=>b({designElements:e}),onNavigateToNext:()=>r("categorization")}),"categorization"===i&&(0,n.jsx)(G,{systemCategorizations:s.systemCategorizations,onUpdate:e=>b({systemCategorizations:e}),onGenerateRequirements:e=>{h(t=>({...t,requirements:[...t.requirements,...e]})),r("requirements")},onNavigateToNext:()=>r("requirements")}),"requirements"===i&&(0,n.jsx)(w,{requirements:s.requirements,onUpdate:e=>b({requirements:e})}),"stig"===i&&(0,n.jsx)(E,{stigRequirements:s.stigRequirements,onUpdate:e=>b({stigRequirements:e})}),"stig-families"===i&&(0,n.jsx)(Y,{requirements:s.requirements,designElements:s.designElements,onLoadStigFamilies:e=>{(async()=>{let i=await V(e),n=new Set(i.map(e=>e.family||""));t(e.filter(e=>!n.has(e))),h(e=>({...e,stigRequirements:[...e.stigRequirements,...i]})),r("stig")})()}}),"matrix"===i&&(0,n.jsx)(T,{data:s,onUpdate:b})]})]})}}},e=>{e.O(0,[316,441,255,358],()=>e(e.s=648)),_N_E=e.O()}]);